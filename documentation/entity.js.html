<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>entity.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><details><summary>bento</summary><a href="module-bento.html">bento</a><ul class='methods'><li data-type='method'><a href="module-bento.html#getCanvas">getCanvas</a></li><li data-type='method'><a href="module-bento.html#getGameData">getGameData</a></li><li data-type='method'><a href="module-bento.html#getRenderer">getRenderer</a></li><li data-type='method'><a href="module-bento.html#getViewport">getViewport</a></li><li data-type='method'><a href="module-bento.html#setup">setup</a></li></ul></details></li><li><details><summary>bento/autoresize</summary><a href="module-bento_autoresize.html">bento/autoresize</a></details></li><li><details><summary>bento/color</summary><a href="module-bento_color.html">bento/color</a></details></li><li><details><summary>bento/components/animation</summary><a href="module-bento_components_animation.html">bento/components/animation</a><ul class='methods'><li data-type='method'><a href="module-bento_components_animation.html#draw">draw</a></li><li data-type='method'><a href="module-bento_components_animation.html#getAnimation">getAnimation</a></li><li data-type='method'><a href="module-bento_components_animation.html#getCurrentFrame">getCurrentFrame</a></li><li data-type='method'><a href="module-bento_components_animation.html#getFrameWidth">getFrameWidth</a></li><li data-type='method'><a href="module-bento_components_animation.html#setAnimation">setAnimation</a></li><li data-type='method'><a href="module-bento_components_animation.html#setCurrentSpeed">setCurrentSpeed</a></li><li data-type='method'><a href="module-bento_components_animation.html#setFrame">setFrame</a></li><li data-type='method'><a href="module-bento_components_animation.html#setup">setup</a></li><li data-type='method'><a href="module-bento_components_animation.html#update">update</a></li></ul></details></li><li><details><summary>bento/components/clickable</summary><a href="module-bento_components_clickable.html">bento/components/clickable</a><ul class='methods'><li data-type='method'><a href="module-bento_components_clickable.html#destroy">destroy</a></li><li data-type='method'><a href="module-bento_components_clickable.html#start">start</a></li><li data-type='method'><a href="module-bento_components_clickable.html#update">update</a></li></ul></details></li><li><details><summary>bento/components/fill</summary><a href="module-bento_components_fill.html">bento/components/fill</a></details></li><li><details><summary>bento/components/opacity</summary><a href="module-bento_components_opacity.html">bento/components/opacity</a></details></li><li><details><summary>bento/components/pixi</summary><a href="module-bento_components_pixi.html">bento/components/pixi</a><ul class='methods'><li data-type='method'><a href="module-bento_components_pixi.html#getAnimation">getAnimation</a></li><li data-type='method'><a href="module-bento_components_pixi.html#getCurrentFrame">getCurrentFrame</a></li><li data-type='method'><a href="module-bento_components_pixi.html#getFrameWidth">getFrameWidth</a></li><li data-type='method'><a href="module-bento_components_pixi.html#setAnimation">setAnimation</a></li><li data-type='method'><a href="module-bento_components_pixi.html#setCurrentSpeed">setCurrentSpeed</a></li><li data-type='method'><a href="module-bento_components_pixi.html#setFrame">setFrame</a></li><li data-type='method'><a href="module-bento_components_pixi.html#update">update</a></li></ul></details></li><li><details><summary>bento/components/rotation</summary><a href="module-bento_components_rotation.html">bento/components/rotation</a></details></li><li><details><summary>bento/components/scale</summary><a href="module-bento_components_scale.html">bento/components/scale</a></details></li><li><details><summary>bento/components/sprite</summary><a href="module-bento_components_sprite.html">bento/components/sprite</a></details></li><li><details><summary>bento/components/translation</summary><a href="module-bento_components_translation.html">bento/components/translation</a></details></li><li><details><summary>bento/eventsystem</summary><a href="module-bento_eventsystem.html">bento/eventsystem</a><ul class='methods'><li data-type='method'><a href="module-bento_eventsystem.html#fire">fire</a></li><li data-type='method'><a href="module-bento_eventsystem.html#off">off</a></li><li data-type='method'><a href="module-bento_eventsystem.html#on">on</a></li></ul></details></li><li><details><summary>bento/managers/asset</summary><a href="module-bento_managers_asset.html">bento/managers/asset</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_asset.html#getAssetGroups">getAssetGroups</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getAssets">getAssets</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getAudio">getAudio</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getImage">getImage</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getImageElement">getImageElement</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getJson">getJson</a></li><li data-type='method'><a href="module-bento_managers_asset.html#load">load</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadAssetGroups">loadAssetGroups</a></li><li data-type='method'><a href="module-bento_managers_asset.html#unload">unload</a></li></ul></details></li><li><details><summary>bento/managers/audio</summary><a href="module-bento_managers_audio.html">bento/managers/audio</a></details></li><li><details><summary>bento/managers/input</summary><a href="module-bento_managers_input.html">bento/managers/input</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_input.html#getPointers">getPointers</a></li><li data-type='method'><a href="module-bento_managers_input.html#isKeyDown">isKeyDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#resetPointers">resetPointers</a></li><li data-type='method'><a href="module-bento_managers_input.html#resume">resume</a></li><li data-type='method'><a href="module-bento_managers_input.html#stop">stop</a></li></ul></details></li><li><details><summary>bento/managers/object</summary><a href="module-bento_managers_object.html">bento/managers/object</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_object.html#attach">attach</a></li><li data-type='method'><a href="module-bento_managers_object.html#count">count</a></li><li data-type='method'><a href="module-bento_managers_object.html#draw">draw</a></li><li data-type='method'><a href="module-bento_managers_object.html#get">get</a></li><li data-type='method'><a href="module-bento_managers_object.html#getByFamily">getByFamily</a></li><li data-type='method'><a href="module-bento_managers_object.html#getByName">getByName</a></li><li data-type='method'><a href="module-bento_managers_object.html#isPaused">isPaused</a></li><li data-type='method'><a href="module-bento_managers_object.html#pause">pause</a></li><li data-type='method'><a href="module-bento_managers_object.html#remove">remove</a></li><li data-type='method'><a href="module-bento_managers_object.html#removeAll">removeAll</a></li><li data-type='method'><a href="module-bento_managers_object.html#resume">resume</a></li><li data-type='method'><a href="module-bento_managers_object.html#run">run</a></li><li data-type='method'><a href="module-bento_managers_object.html#stop">stop</a></li></ul></details></li><li><details><summary>bento/managers/savestate</summary><a href="module-bento_managers_savestate.html">bento/managers/savestate</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_savestate.html#clear">clear</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#load">load</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#remove">remove</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#save">save</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#setId">setId</a></li></ul></details></li><li><details><summary>bento/managers/screen</summary><a href="module-bento_managers_screen.html">bento/managers/screen</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_screen.html#add">add</a></li><li data-type='method'><a href="module-bento_managers_screen.html#getCurrentScreen">getCurrentScreen</a></li><li data-type='method'><a href="module-bento_managers_screen.html#hide">hide</a></li><li data-type='method'><a href="module-bento_managers_screen.html#show">show</a></li></ul></details></li><li><details><summary>bento/math/array2d</summary><a href="module-bento_math_array2d.html">bento/math/array2d</a><ul class='methods'><li data-type='method'><a href="module-bento_math_array2d.html#get">get</a></li><li data-type='method'><a href="module-bento_math_array2d.html#isArray2d">isArray2d</a></li><li data-type='method'><a href="module-bento_math_array2d.html#iterate">iterate</a></li><li data-type='method'><a href="module-bento_math_array2d.html#set">set</a></li></ul></details></li><li><details><summary>bento/math/matrix</summary><a href="module-bento_math_matrix.html">bento/math/matrix</a><ul class='methods'><li data-type='method'><a href="module-bento_math_matrix.html#add">add</a></li><li data-type='method'><a href="module-bento_math_matrix.html#addTo">addTo</a></li><li data-type='method'><a href="module-bento_math_matrix.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_matrix.html#get">get</a></li><li data-type='method'><a href="module-bento_math_matrix.html#getHeight">getHeight</a></li><li data-type='method'><a href="module-bento_math_matrix.html#getWidth">getWidth</a></li><li data-type='method'><a href="module-bento_math_matrix.html#isMatrix">isMatrix</a></li><li data-type='method'><a href="module-bento_math_matrix.html#iterate">iterate</a></li><li data-type='method'><a href="module-bento_math_matrix.html#multiply">multiply</a></li><li data-type='method'><a href="module-bento_math_matrix.html#multiplyWith">multiplyWith</a></li><li data-type='method'><a href="module-bento_math_matrix.html#set">set</a></li><li data-type='method'><a href="module-bento_math_matrix.html#setValues">setValues</a></li><li data-type='method'><a href="module-bento_math_matrix.html#stringify">stringify</a></li><li data-type='method'><a href="module-bento_math_matrix.html#transpose">transpose</a></li></ul></details></li><li><details><summary>bento/math/polygon</summary><a href="module-bento_math_polygon.html">bento/math/polygon</a><ul class='methods'><li data-type='method'><a href="module-bento_math_polygon.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_polygon.html#getBoundingBox">getBoundingBox</a></li><li data-type='method'><a href="module-bento_math_polygon.html#hasPosition">hasPosition</a></li><li data-type='method'><a href="module-bento_math_polygon.html#intersect">intersect</a></li><li data-type='method'><a href="module-bento_math_polygon.html#isPolygon">isPolygon</a></li><li data-type='method'><a href="module-bento_math_polygon.html#offset">offset</a></li></ul></details></li><li><details><summary>bento/packedimage</summary><a href="module-bento_packedimage.html">bento/packedimage</a></details></li><li><details><summary>bento/renderer</summary><a href="module-bento_renderer.html">bento/renderer</a></details></li><li><details><summary>bento/screen</summary><a href="module-bento_screen.html">bento/screen</a><ul class='methods'><li data-type='method'><a href="module-bento_screen.html#getDimension">getDimension</a></li><li data-type='method'><a href="module-bento_screen.html#loadTiled">loadTiled</a></li><li data-type='method'><a href="module-bento_screen.html#onHide">onHide</a></li><li data-type='method'><a href="module-bento_screen.html#onShow">onShow</a></li><li data-type='method'><a href="module-bento_screen.html#setDimension">setDimension</a></li></ul></details></li><li><details><summary>bento/tiled</summary><a href="module-bento_tiled.html">bento/tiled</a><ul class='methods'><li data-type='method'><a href="module-bento_tiled.html#moveTo">moveTo</a></li><li data-type='method'><a href="module-bento_tiled.html#remove">remove</a></li></ul></details></li><li><details><summary>bento/tween</summary><a href="module-bento_tween.html">bento/tween</a></details></li><li><details><summary>bento/utils</summary><a href="module-bento_utils.html">bento/utils</a><ul class='methods'><li data-type='method'><a href="module-bento_utils.html#approach">approach</a></li><li data-type='method'><a href="module-bento_utils.html#extend">extend</a></li><li data-type='method'><a href="module-bento_utils.html#getKeyLength">getKeyLength</a></li><li data-type='method'><a href="module-bento_utils.html#getRandom">getRandom</a></li><li data-type='method'><a href="module-bento_utils.html#isAndroid">isAndroid</a></li><li data-type='method'><a href="module-bento_utils.html#isApple">isApple</a></li><li data-type='method'><a href="module-bento_utils.html#isArray">isArray</a></li><li data-type='method'><a href="module-bento_utils.html#isBoolean">isBoolean</a></li><li data-type='method'><a href="module-bento_utils.html#isCocoonJS">isCocoonJS</a></li><li data-type='method'><a href="module-bento_utils.html#isDefined">isDefined</a></li><li data-type='method'><a href="module-bento_utils.html#isFunction">isFunction</a></li><li data-type='method'><a href="module-bento_utils.html#isInt">isInt</a></li><li data-type='method'><a href="module-bento_utils.html#isNumber">isNumber</a></li><li data-type='method'><a href="module-bento_utils.html#isObject">isObject</a></li><li data-type='method'><a href="module-bento_utils.html#isString">isString</a></li><li data-type='method'><a href="module-bento_utils.html#isUndefined">isUndefined</a></li><li data-type='method'><a href="module-bento_utils.html#removeObject">removeObject</a></li><li data-type='method'><a href="module-bento_utils.html#sign">sign</a></li><li data-type='method'><a href="module-bento_utils.html#toRadian">toRadian</a></li></ul></details></li></ul><h3>Global</h3><ul><li><a href="global.html">attach</a></li><li><a href="global.html">attached</a></li><li><a href="global.html#bento">bento</a></li><li><a href="global.html">clone</a></li><li><a href="global.html">collidesWith</a></li><li><a href="global.html">collidesWithGroup</a></li><li><a href="global.html">destroy</a></li><li><a href="global.html">draw</a></li><li><a href="global.html">extend</a></li><li><a href="global.html">float</a></li><li><a href="global.html">getBoundingBox</a></li><li><a href="global.html">getComponentByName</a></li><li><a href="global.html">getX2</a></li><li><a href="global.html">getY2</a></li><li><a href="global.html">global</a></li><li><a href="global.html">grow</a></li><li><a href="global.html">hasPosition</a></li><li><a href="global.html">height</a></li><li><a href="global.html">intersect</a></li><li><a href="global.html">intersection</a></li><li><a href="global.html">isRectangle</a></li><li><a href="global.html">moveComponentTo</a></li><li><a href="global.html">name</a></li><li><a href="global.html">offset</a></li><li><a href="global.html">remove</a></li><li><a href="global.html">setOriginRelative</a></li><li><a href="global.html">start</a></li><li><a href="global.html">timer</a></li><li><a href="global.html">union</a></li><li><a href="global.html">update</a></li><li><a href="global.html">updateWhenPaused</a></li><li><a href="global.html">useHshg</a></li><li><a href="global.html">width</a></li><li><a href="global.html">x</a></li><li><a href="global.html">y</a></li><li><a href="global.html">z</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">entity.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * A base object to hold components
 * &lt;br>Exports: Function
 * @entity {Entity} bento/entity
 * @param {Object} settings - settings (all properties are optional)
 * @param {Function} settings.init - Called when entity is initialized
 * @param {Function} settings.onCollide - Called when object collides in HSHG
 * @param {Array} settings.components - Array of component module functions
 * @param {Array} settings.family - Array of family names
 * @param {Vector2} settings.position - Vector2 of position to set
 * @param {Vector2} settings.origin - Vector2 of origin to set
 * @param {Vector2} settings.originRelative - Vector2 of relative origin to set
 * @param {Boolean} settings.z - z-index to set
 * @param {Boolean} settings.updateWhenPaused - Should entity keep updating when game is paused
 * @param {Boolean} settings.global - Should entity remain after hiding a screen
 * @param {Boolean} settings.float - Should entity move with the screen
 * @param {Boolean} settings.useHshg - Should entity use HSHG for collisions
 * @param {Boolean} settings.staticHshg - Is entity a static object in HSHG (doesn't check collisions on others, but can get checked on)
 * @returns {Entity} Returns a new entity object
 */
bento.define('bento/entity', [
    'bento',
    'bento/utils',
    'bento/math/vector2',
    'bento/math/rectangle'
], function (Bento, Utils, Vector2, Rectangle) {
    'use strict';
    var cleanComponents = function (entity) {
        // remove null components
        var i;
        for (i = entity.components.length - 1; i >= 0; --i) {
            if (!entity.components[i]) {
                entity.components.splice(i, 1);
            }
        }
    };

    var entity = function (settings) {
        /**
         * z-index of an object
         * @instance
         * @default 0
         * @name z
         */
        this.z = 0;
        /**
         * Timer value, incremented every update step
         * @instance
         * @default 0
         * @name timer
         */
        this.timer = 0;
        /**
         * Indicates if an object should not be destroyed when a Screen ends
         * @instance
         * @default false
         * @name global
         */
        this.global = false;
        /**
         * Indicates if an object should move with the scrolling of the screen
         * @instance
         * @default false
         * @name float
         */
        this.float = false;
        /**
         * Indicates if an object should continue updating when the game is paused
         * @instance
         * @default false
         * @name updateWhenPaused
         */
        this.updateWhenPaused = false;
        /**
         * Name of an object
         * @instance
         * @default ''
         * @name name
         */
        this.name = '';
        this.isAdded = false;
        /**
         * Name of an object
         * @instance
         * @default ''
         * @name useHshg
         */
        this.useHshg = false;
        this.position = new Vector2(0, 0);
        this.origin = new Vector2(0, 0);
        this.family = [];
        this.components = [];
        this.dimension = new Rectangle(0, 0, 0, 0);
        this.boundingBox = new Rectangle(0, 0, null, null);
        this.scale = new Vector2(1, 1);
        this.rotation = 0;
        this.visible = true;
        this.parent = null;

        // read settings
        if (settings) {
            if (settings.components) {
                if (!Utils.isArray(settings.components)) {
                    settings.components = [settings.components];
                }
                for (var i = 0; i &lt; settings.components.length; ++i) {
                    settings.components[i](this, settings);
                }
            }
            if (settings.position) {
                this.position = settings.position;
            }
            if (settings.origin) {
                this.origin = settings.origin;
            }
            if (settings.originRelative) {
                this.setOriginRelative(settings.originRelative);
            }
            if (settings.name) {
                this.name = settings.name;
            }
            if (settings.family) {
                if (!Utils.isArray(settings.family)) {
                    settings.family = [settings.family];
                }
                for (var i = 0; i &lt; settings.family.length; ++i) {
                    this.family.push(settings.family[i]);
                }
            }
            if (settings.init) {
                settings.init.apply(this);
            }

            this.z = settings.z || 0;
            this.updateWhenPaused = settings.updateWhenPaused || false;
            this.global = settings.global || false;
            this.float = settings.float || false;
            this.useHshg = settings.useHshg || false;
            this.staticHshg = settings.staticHshg || false;
            this.onCollide = settings.onCollide;

            if (settings.addNow) {
                Bento.objects.add(this);
            }
        }
    };

    /**
     * Calls start on every component
     * @function
     * @param {Object} data - gameData object
     * @instance
     * @name start
     */
    entity.prototype.start = function (data) {
        var i,
            l,
            component;
        if (data) {
            data.entity = this;
        }
        // update components
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component &amp;&amp; component.start) {
                component.start(data);
            }
        }
    };
    /**
     * Calls destroy on every component
     * @function
     * @param {Object} data - gameData object
     * @instance
     * @name destroy
     */
    entity.prototype.destroy = function (data) {
        var i,
            l,
            component;
        if (data) {
            data.entity = this;
        }
        // update components
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component &amp;&amp; component.destroy) {
                component.destroy(data);
            }
        }
    };
    /**
     * Calls update on every component
     * @function
     * @param {Object} data - gameData object
     * @instance
     * @name update
     */
    entity.prototype.update = function (data) {
        var i,
            l,
            component;

        if (data) {
            data.entity = this;
        }
        // update components
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component &amp;&amp; component.update) {
                component.update(data);
            }
        }
        ++this.timer;

        // clean up
        cleanComponents(this);
    };
    /**
     * Calls draw on every component
     * @function
     * @param {Object} data - gameData object
     * @instance
     * @name draw
     */
    entity.prototype.draw = function (data) {
        var i,
            l,
            component;
        if (!this.visible) {
            return;
        }
        if (data) {
            data.entity = this;
        }
        // call components
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component &amp;&amp; component.draw) {
                component.draw(data);
            }
        }
        // post draw
        for (i = this.components.length - 1; i >= 0; i--) {
            component = this.components[i];
            if (component &amp;&amp; component.postDraw) {
                component.postDraw(data);
            }
        }
    };
    /**
     * Extends properties of entity
     * @function
     * @instance
     * @param {Object} object - other object
     * @see module:bento/utils#extend
     * @name extend
     */
    entity.prototype.extend = function (object) {
        return Utils.extend(this, object);
    };
    /**
     * Returns the bounding box of an entity. If no bounding box was set
     * previously, the dimension is returned.
     * @function
     * @returns {Rectangle} boundingbox - Entity's boundingbox
     * @instance
     * @name getBoundingBox
     */
    entity.prototype.getBoundingBox = function () {
        var scale, x1, x2, y1, y2, box;
        if (!this.boundingBox.width) {
            // TODO get rid of scale component dependency
            scale = this.scale ? this.scale : new Vector2(1, 1);
            x1 = this.position.x - this.origin.x * scale.x;
            y1 = this.position.y - this.origin.y * scale.y;
            x2 = this.position.x + (this.dimension.width - this.origin.x) * scale.x;
            y2 = this.position.y + (this.dimension.height - this.origin.y) * scale.y;
            // swap variables if scale is negative
            if (scale.x &lt; 0) {
                x2 = [x1, x1 = x2][0];
            }
            if (scale.y &lt; 0) {
                y2 = [y1, y1 = y2][0];
            }
            return new Rectangle(x1, y1, x2 - x1, y2 - y1);
        } else {
            // TODO: cloning could be expensive for polygons
            box = this.boundingBox.clone();
            scale = this.scale ? this.scale : new Vector2(1, 1);
            box.x *= Math.abs(scale.x);
            box.y *= Math.abs(scale.y);
            box.width *= Math.abs(scale.x);
            box.height *= Math.abs(scale.y);
            box.x += this.position.x;
            box.y += this.position.y;
            return box;
        }
    };
    /**
     * Sets the origin relatively (0...1)
     * @function
     * @param {Vector2} origin - Position of the origin (relative to upper left corner of the dimension)
     * @instance
     * @name setOriginRelative
     */
    entity.prototype.setOriginRelative = function (value) {
        this.origin.x = value.x * this.dimension.width;
        this.origin.y = value.y * this.dimension.height;
    };
    /**
     * Entity was attached ()
     * @param {Object} data - gameData
     * @instance
     * @name attached
     */
    entity.prototype.attached = function (data) {
        var i,
            l,
            component;

        if (data) {
            data.entity = this;
        } else {
            data = {
                entity: this
            };
        }
        // update components
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component) {
                // shouldnt propagate
                if (component.parent) {
                    continue;
                }
                if (component.attached) {
                    component.attached(data);
                }
            }
        }
    };
    /**
     * Attaches a child object to the entity. Entities can form a scenegraph.
     * Generally, entities act as nodes while components act like leaves.
     * Note that start will be called in the child.
     * @function
     * @param {Object} node - The child object to attach
     * @param {String} [name] - Name to expose in the entity. The child object can be reached by entity[name]
     * @instance
     * @name attach
     */
    entity.prototype.attach = function (component, name) {
        var mixin = {},
            parent = this;

        this.components.push(component);
        if (component.setParent) {
            component.setParent(entity);
        }
        if (component.init) {
            component.init();
        }
        if (component.attached) {
            component.attached({
                entity: this
            });
        }
        if (this.isAdded) {
            if (component.start) {
                component.start();
            }
        } else {
            if (parent.parent) {
                parent = parent.parent;
            }
            while (parent) {
                if (parent.isAdded) {
                    if (component.start) {
                        component.start();
                    }
                }
                parent = parent.parent;
            }
        }
        return this;
    };
    /**
     * Removes a child object from the entity. Note that destroy will be called in the child.
     * @function
     * @param {Object} node - The child object to remove
     * @instance
     * @name remove
     */
    entity.prototype.remove = function (component) {
        var i, type, index;
        if (!component) {
            return;
        }
        index = this.components.indexOf(component);
        if (index >= 0) {
            if (component.destroy) {
                component.destroy();
            }
            // TODO: clean component
            this.components[index] = null;
        }
        return this;
    };
    /**
     * Returns the first child found with a certain name
     * @function
     * @instance
     * @param {String} name - name of the component
     * @name getComponentByName
     */
    entity.prototype.getComponentByName = function (name) {
        var i, l, component;
        for (i = 0, l = this.components.length; i &lt; l; ++i) {
            component = this.components[i];
            if (component.name === name) {
                return component;
            }
        }
    };
    /**
     * Moves a child to a certain index in the array
     * @function
     * @instance
     * @param {Object} child - reference to the child
     * @param {Number} index - new index
     * @name moveComponentTo
     */
    entity.prototype.moveComponentTo = function (component, newIndex) {
        // note: currently dangerous to do during an update loop
        var i, type, index;
        if (!component) {
            return;
        }
        index = this.components.indexOf(component);
        if (index >= 0) {
            // remove old
            this.components.splice(index, 1);
            // insert at new place
            this.components.splice(newIndex, 0, component);
        }
    };
    /**
     * Callback when entities collide.
     *
     * @callback CollisionCallback
     * @param {Entity} other - The other entity colliding
     */
    /**
     * Checks if entity is colliding with another entity
     * @function
     * @instance
     * @param {Entity} other - The other entity
     * @param {Vector2} [offset] - A position offset
     * @param {CollisionCallback} [callback] - Called when entities are colliding
     * @name collidesWith
     */
    entity.prototype.collidesWith = function (other, offset, callback) {
        var intersect;
        if (!Utils.isDefined(offset)) {
            offset = new Vector2(0, 0);
        }
        intersect = this.boundingBox.offset(offset).intersect(other.boundingBox);
        if (intersect &amp;&amp; callback) {
            callback(other);
        }
        return intersect;
    };
    /**
     * Checks if entity is colliding with any entity in an array
     * Returns the first entity it finds that collides with the entity.
     * @function
     * @instance
     * @param {Array} other - Array of entities, ignores self if present
     * @param {Vector2} [offset] - A position offset
     * @param {CollisionCallback} [callback] - Called when entities are colliding
     * @name collidesWithGroup
     */
    entity.prototype.collidesWithGroup = function (array, offset, callback) {
        var i,
            obj,
            box;
        if (!Utils.isDefined(offset)) {
            offset = new Vector2(0, 0);
        }
        if (!Utils.isArray(array)) {
            // throw 'Collision check must be with an Array of object';
            console.log('Collision check must be with an Array of object');
            return;
        }
        if (!array.length) {
            return null;
        }
        box = this.boundingBox.offset(offset);
        for (i = 0; i &lt; array.length; ++i) {
            obj = array[i];
            if (obj === this) {
                continue;
            }
            if (obj.boundingBox &amp;&amp; box.intersect(obj.boundingBox)) {
                if (callback) {
                    callback(obj);
                }
                return obj;
            }
        }
        return null;
    };
    entity.prototype.getAABB = function () {
        var box = this.boundingBox;
        return {
            min: [box.x, box.y],
            max: [box.x + box.width, box.y + box.height]
        };
    };

    return entity;
});</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Tue Sep 08 2015 09:49:56 GMT+0200 (CEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/opennav.js"></script>
</body>
</html>
