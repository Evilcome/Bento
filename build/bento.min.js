!function(){var e={},t=null,n=!0,i=!1;try{"undefined"!=typeof AudioContext?t=new AudioContext:"undefined"!=typeof webkitAudioContext?t=new webkitAudioContext:n=!1}catch(o){n=!1}if(!n)if("undefined"!=typeof Audio)try{new Audio}catch(o){i=!0}else i=!0;if(n){var r="undefined"==typeof t.createGain?t.createGainNode():t.createGain();r.gain.value=1,r.connect(t.destination)}var a=function(){this._volume=1,this._muted=!1,this.usingWebAudio=n,this.noAudio=i,this._howls=[]};a.prototype={volume:function(e){var t=this;if(e=parseFloat(e),e>=0&&1>=e){t._volume=e,n&&(r.gain.value=e);for(var i in t._howls)if(t._howls.hasOwnProperty(i)&&t._howls[i]._webAudio===!1)for(var o=0;o<t._howls[i]._audioNode.length;o++)t._howls[i]._audioNode[o].volume=t._howls[i]._volume*t._volume;return t}return n?r.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t=this;t._muted=e,n&&(r.gain.value=e?0:t._volume);for(var i in t._howls)if(t._howls.hasOwnProperty(i)&&t._howls[i]._webAudio===!1)for(var o=0;o<t._howls[i]._audioNode.length;o++)t._howls[i]._audioNode[o].muted=e}};var s=new a,u=null;if(!i){u=new Audio;var c={mp3:!!u.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!u.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!u.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!u.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!u.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(u.canPlayType("audio/x-m4a;")||u.canPlayType("audio/m4a;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(u.canPlayType("audio/x-mp4;")||u.canPlayType("audio/mp4;")||u.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!u.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var d=function(e){var t=this;t._autoplay=e.autoplay||!1,t._buffer=e.buffer||!1,t._duration=e.duration||0,t._format=e.format||null,t._loop=e.loop||!1,t._loaded=!1,t._sprite=e.sprite||{},t._src=e.src||"",t._pos3d=e.pos3d||[0,0,-.5],t._volume=void 0!==e.volume?e.volume:1,t._urls=e.urls||[],t._rate=e.rate||1,t._model=e.model||null,t._onload=[e.onload||function(){}],t._onloaderror=[e.onloaderror||function(){}],t._onend=[e.onend||function(){}],t._onpause=[e.onpause||function(){}],t._onplay=[e.onplay||function(){}],t._onendTimer=[],t._webAudio=n&&!t._buffer,t._audioNode=[],t._webAudio&&t._setupAudioNode(),s._howls.push(t),t.load()};if(d.prototype={load:function(){var t=this,n=null;if(i)return void t.on("loaderror");for(var o=0;o<t._urls.length;o++){var r,u;if(t._format)r=t._format;else{if(u=t._urls[o].toLowerCase().split("?")[0],r=u.match(/.+\.([^?]+)(\?|$)/),r=r&&r.length>=2?r:u.match(/data\:audio\/([^?]+);/),!r)return void t.on("loaderror");r=r[1]}if(c[r]){n=t._urls[o];break}}if(!n)return void t.on("loaderror");if(t._src=n,t._webAudio)l(t,n);else{var d=new Audio;d.addEventListener("error",function(){d.error&&4===d.error.code&&(a.noAudio=!0),t.on("loaderror",{type:d.error?d.error.code:0})},!1),t._audioNode.push(d),d.src=n,d._pos=0,d.preload="auto",d.volume=s._muted?0:t._volume*s.volume(),e[n]=t;var f=function(){t._duration=Math.ceil(10*d.duration)/10,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play(),d.removeEventListener("canplaythrough",f,!1)};d.addEventListener("canplaythrough",f,!1),d.load()}return t},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(e,n){var i=this;return"function"==typeof e&&(n=e),e&&"function"!=typeof e||(e="_default"),i._loaded?i._sprite[e]?(i._inactiveNode(function(o){o._sprite=e;var r=o._pos>0?o._pos:i._sprite[e][0]/1e3,a=0;i._webAudio?(a=i._sprite[e][1]/1e3-o._pos,o._pos>0&&(r=i._sprite[e][0]/1e3+r)):a=i._sprite[e][1]/1e3-(r-i._sprite[e][0]/1e3);var u,c=!(!i._loop&&!i._sprite[e][2]),d="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(function(){var t={id:d,sprite:e,loop:c};u=setTimeout(function(){!i._webAudio&&c&&i.stop(t.id).play(e,t.id),i._webAudio&&!c&&(i._nodeById(t.id).paused=!0,i._nodeById(t.id)._pos=0),i._webAudio||c||i.stop(t.id),i.on("end",d)},1e3*a),i._onendTimer.push({timer:u,id:t.id})}(),i._webAudio){var l=i._sprite[e][0]/1e3,f=i._sprite[e][1]/1e3;o.id=d,o.paused=!1,h(i,[c,l,f],d),i._playStart=t.currentTime,o.gain.value=i._volume,"undefined"==typeof o.bufferSource.start?o.bufferSource.noteGrainOn(0,r,a):o.bufferSource.start(0,r,a)}else{if(4!==o.readyState&&(o.readyState||!navigator.isCocoonJS))return i._clearEndTimer(d),function(){var t=i,r=e,a=n,s=o,u=function(){t.play(r,a),s.removeEventListener("canplaythrough",u,!1)};s.addEventListener("canplaythrough",u,!1)}(),i;o.readyState=4,o.id=d,o.currentTime=r,o.muted=s._muted||o.muted,o.volume=i._volume*s.volume(),setTimeout(function(){o.play()},0)}return i.on("play"),"function"==typeof n&&n(d),i}),i):("function"==typeof n&&n(),i):(i.on("load",function(){i.play(e,n)}),i)},pause:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.pause(e)}),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=t.pos(null,e),t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else n.pause();return t.on("pause"),t},stop:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.stop(e)}),t;t._clearEndTimer(e);var n=e?t._nodeById(e):t._activeNode();if(n)if(n._pos=0,t._webAudio){if(!n.bufferSource||n.paused)return t;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else isNaN(n.duration)||(n.pause(),n.currentTime=0);return t},mute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.mute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=0:n.muted=!0),t},unmute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.unmute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=t._volume:n.muted=!1),t},volume:function(e,t){var n=this;if(e=parseFloat(e),e>=0&&1>=e){if(n._volume=e,!n._loaded)return n.on("play",function(){n.volume(e,t)}),n;var i=t?n._nodeById(t):n._activeNode();return i&&(n._webAudio?i.gain.value=e:i.volume=e*s.volume()),n}return n._volume},loop:function(e){var t=this;return"boolean"==typeof e?(t._loop=e,t):t._loop},sprite:function(e){var t=this;return"object"==typeof e?(t._sprite=e,t):t._sprite},pos:function(e,n){var i=this;if(!i._loaded)return i.on("load",function(){i.pos(e)}),"number"==typeof e?i:i._pos||0;e=parseFloat(e);var o=n?i._nodeById(n):i._activeNode();if(o)return e>=0?(i.pause(n),o._pos=e,i.play(o._sprite,n),i):i._webAudio?o._pos+(t.currentTime-i._playStart):o.currentTime;if(e>=0)return i;for(var r=0;r<i._audioNode.length;r++)if(i._audioNode[r].paused&&4===i._audioNode[r].readyState)return i._webAudio?i._audioNode[r]._pos:i._audioNode[r].currentTime},pos3d:function(e,t,n,i){var o=this;if(t="undefined"!=typeof t&&t?t:0,n="undefined"!=typeof n&&n?n:-.5,!o._loaded)return o.on("play",function(){o.pos3d(e,t,n,i)}),o;if(!(e>=0||0>e))return o._pos3d;if(o._webAudio){var r=i?o._nodeById(i):o._activeNode();r&&(o._pos3d=[e,t,n],r.panner.setPosition(e,t,n),r.panner.panningModel=o._model||"HRTF")}return o},fade:function(e,t,n,i,o){var r=this,a=Math.abs(e-t),s=e>t?"down":"up",u=a/.01,c=n/u;if(!r._loaded)return r.on("load",function(){r.fade(e,t,n,i,o)}),r;r.volume(e,o);for(var d=1;u>=d;d++)!function(){var e=r._volume+("up"===s?.01:-.01)*d,n=Math.round(1e3*e)/1e3,a=t;setTimeout(function(){r.volume(n,o),n===a&&i&&i()},c*d)}()},fadeIn:function(e,t,n){return this.volume(0).play().fade(0,e,t,n)},fadeOut:function(e,t,n,i){var o=this;return o.fade(o._volume,e,t,function(){n&&n(),o.pause(i),o.on("end")},i)},_nodeById:function(e){for(var t=this,n=t._audioNode[0],i=0;i<t._audioNode.length;i++)if(t._audioNode[i].id===e){n=t._audioNode[i];break}return n},_activeNode:function(){for(var e=this,t=null,n=0;n<e._audioNode.length;n++)if(!e._audioNode[n].paused){t=e._audioNode[n];break}return e._drainPool(),t},_inactiveNode:function(e){for(var t=this,n=null,i=0;i<t._audioNode.length;i++)if(t._audioNode[i].paused&&4===t._audioNode[i].readyState){e(t._audioNode[i]),n=!0;break}if(t._drainPool(),!n){var o;if(t._webAudio)o=t._setupAudioNode(),e(o);else{t.load(),o=t._audioNode[t._audioNode.length-1];var r=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",a=function(){o.removeEventListener(r,a,!1),e(o)};o.addEventListener(r,a,!1)}}},_drainPool:function(){var e,t=this,n=0;for(e=0;e<t._audioNode.length;e++)t._audioNode[e].paused&&n++;for(e=t._audioNode.length-1;e>=0&&!(5>=n);e--)t._audioNode[e].paused&&(t._webAudio&&t._audioNode[e].disconnect(0),n--,t._audioNode.splice(e,1))},_clearEndTimer:function(e){for(var t=this,n=0,i=0;i<t._onendTimer.length;i++)if(t._onendTimer[i].id===e){n=i;break}var o=t._onendTimer[n];o&&(clearTimeout(o.timer),t._onendTimer.splice(n,1))},_setupAudioNode:function(){var e=this,n=e._audioNode,i=e._audioNode.length;return n[i]="undefined"==typeof t.createGain?t.createGainNode():t.createGain(),n[i].gain.value=e._volume,n[i].paused=!0,n[i]._pos=0,n[i].readyState=4,n[i].connect(r),n[i].panner=t.createPanner(),n[i].panner.panningModel=e._model||"equalpower",n[i].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),n[i].panner.connect(n[i]),n[i]},on:function(e,t){var n=this,i=n["_on"+e];if("function"==typeof t)i.push(t);else for(var o=0;o<i.length;o++)t?i[o].call(n,t):i[o].call(n);return n},off:function(e,t){for(var n=this,i=n["_on"+e],o=t.toString(),r=0;r<i.length;r++)if(o===i[r].toString()){i.splice(r,1);break}return n},unload:function(){for(var t=this,n=t._audioNode,i=0;i<t._audioNode.length;i++)n[i].paused||t.stop(n[i].id),t._webAudio?n[i].disconnect(0):n[i].src="";for(i=0;i<t._onendTimer.length;i++)clearTimeout(t._onendTimer[i].timer);var o=s._howls.indexOf(t);null!==o&&o>=0&&s._howls.splice(o,1),delete e[t._src],t=null}},n)var l=function(n,i){if(i in e)n._duration=e[i].duration,f(n);else{var o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="arraybuffer",o.onload=function(){t.decodeAudioData(o.response,function(t){t&&(e[i]=t,f(n,t))},function(){n.on("loaderror")})},o.onerror=function(){n._webAudio&&(n._buffer=!0,n._webAudio=!1,n._audioNode=[],delete n._gainNode,n.load())};try{o.send()}catch(r){o.onerror()}}},f=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},h=function(n,i,o){var r=n._nodeById(o);r.bufferSource=t.createBufferSource(),r.bufferSource.buffer=e[n._src],r.bufferSource.connect(r.panner),r.bufferSource.loop=i[0],i[0]&&(r.bufferSource.loopStart=i[1],r.bufferSource.loopEnd=i[1]+i[2]),r.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:s,Howl:d}}),"undefined"!=typeof exports&&(exports.Howler=s,exports.Howl=d),"undefined"!=typeof window&&(window.Howler=s,window.Howl=d)}();var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,o){(n||!hasProp(e,o))&&(i&&"string"!=typeof t?(e[o]||(e[o]={}),mixin(e[o],t,n,i)):e[o]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var o=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=i,n&&(o.originalError=n),o}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var o,r,a,s,u,c,d,l,f,h,p,g=n&&n.split("/"),m=g,v=C.map,b=v&&v["*"];if(e&&"."===e.charAt(0)&&(n?(m=getOwn(C.pkgs,n)?g=[n]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),r=getOwn(C.pkgs,o=e[0]),e=e.join("/"),r&&e===o+"/"+r.main&&(e=o)):0===e.indexOf("./")&&(e=e.substring(2))),i&&v&&(g||b)){for(s=e.split("/"),u=s.length;u>0;u-=1){if(d=s.slice(0,u).join("/"),g)for(c=g.length;c>0;c-=1)if(a=getOwn(v,g.slice(0,c).join("/")),a&&(a=getOwn(a,d))){l=a,f=u;break}if(l)break;!h&&b&&getOwn(b,d)&&(h=getOwn(b,d),p=u)}!l&&h&&(l=h,f=p),l&&(s.splice(0,f,l),e=s.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function o(e){var t=getOwn(C.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function r(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,i,o){var a,s,u,c,d=null,l=t?t.name:null,f=e,h=!0,p="";return e||(h=!1,e="_@r"+(I+=1)),c=r(e),d=c[0],e=c[1],d&&(d=n(d,l,o),s=getOwn(P,d)),e&&(d?p=s&&s.normalize?s.normalize(e,function(e){return n(e,l,o)}):n(e,l,o):(p=n(e,l,o),c=r(p),d=c[0],p=c[1],i=!0,a=w.nameToUrl(p))),u=!d||s||i?"":"_unnormalized"+(k+=1),{prefix:d,name:p,parentMap:t,unnormalized:!!u,url:a,originalName:f,isDefine:h,id:(d?d+"!"+p:p)+u}}function s(e){var t=e.id,n=getOwn(M,t);return n||(n=M[t]=new w.Module(e)),n}function u(e,t,n){var i=e.id,o=getOwn(M,i);!hasProp(P,i)||o&&!o.defineEmitComplete?(o=s(e),o.error&&"error"===t?n(o.error):o.on(t,n)):"defined"===t&&n(P[i])}function c(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(M,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function d(){globalDefQueue.length&&(apsp.apply(O,[O.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function l(e){delete M[e],delete S[e]}function f(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,o){var r=i.id,a=getOwn(M,r);!a||e.depMatched[o]||n[r]||(getOwn(t,r)?(e.defineDep(o,P[r]),e.check()):f(a,t,n))}),n[i]=!0)}function h(){var e,t,n,r,a=1e3*C.waitSeconds,s=a&&w.startTime+a<(new Date).getTime(),u=[],d=[],l=!1,p=!0;if(!b){if(b=!0,eachProp(S,function(n){if(e=n.map,t=e.id,n.enabled&&(e.isDefine||d.push(n),!n.error))if(!n.inited&&s)o(t)?(r=!0,l=!0):(u.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(l=!0,!e.prefix))return p=!1}),s&&u.length)return n=makeError("timeout","Load timeout for modules: "+u,null,u),n.contextName=w.contextName,c(n);p&&each(d,function(e){f(e,{},{})}),s&&!r||!l||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,h()},50)),b=!1}}function p(e){hasProp(P,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(d();O.length;){if(e=O.shift(),null===e[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));p(e)}}var b,y,w,x,_,C={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},M={},S={},A={},O=[],P={},E={},I=1,k=1;return x={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=P[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,n=getOwn(C.pkgs,e.map.id);return t=n?getOwn(C.config,e.map.id+"/"+n.main):getOwn(C.config,e.map.id),t||{}},exports:P[e.map.id]}}},y=function(e){this.events=getOwn(A,e.id)||{},this.map=e,this.shim=getOwn(C.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;E[e]||(E[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,o=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=w.execCb(n,r,i,o)}catch(a){e=a}else o=w.execCb(n,r,i,o);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?o=t.exports:void 0===o&&this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else o=r;this.exports=o,this.map.isDefine&&!this.ignore&&(P[n]=o,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),l(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),u(i,"defined",bind(this,function(i){var o,r,d,f=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,p=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(f=i.normalize(f,function(e){return n(e,h,!0)})||""),r=a(e.prefix+"!"+f,this.map.parentMap),u(r,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),d=getOwn(M,r.id),void(d&&(this.depMaps.push(r),this.events.error&&d.on("error",bind(this,function(e){this.emit("error",e)})),d.enable()))):(o=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(M,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&l(e.map.id)}),c(e)}),o.fromText=bind(this,function(n,i){var r=e.name,u=a(r),d=useInteractive;i&&(n=i),d&&(useInteractive=!1),s(u),hasProp(C.config,t)&&(C.config[r]=C.config[t]);try{req.exec(n)}catch(l){return c(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}d&&(useInteractive=!0),this.depMaps.push(u),w.completeLoad(r),p([r],o)}),void i.load(e.name,p,o,C))})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,o;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(x,e.id))return void(this.depExports[t]=o(this));this.depCount+=1,u(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&u(e,"error",bind(this,this.errback))}n=e.id,i=M[n],hasProp(x,n)||!i||i.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(M,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:C,contextName:e,registry:M,defined:P,urlFetched:E,defQueue:O,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=C.pkgs,n=C.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?"map"===t?(C.map||(C.map={}),mixin(C[t],e,!0,!0)):mixin(C[t],e,!0):C[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),n[t]=e}),C.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),C.pkgs=t),eachProp(M,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,o){function r(n,i,u){var d,l,f;return o.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?c(makeError("requireargs","Invalid require call"),u):t&&hasProp(x,n)?x[n](M[t.id]):req.get?req.get(w,n,t,r):(l=a(n,t,!1,!0),d=l.id,hasProp(P,d)?P[d]:c(makeError("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),f=s(a(null,t)),f.skipMap=o.skipMap,f.init(n,i,u,{enabled:!0}),h()}),r)}return o=o||{},mixin(r,{isBrowser:isBrowser,toUrl:function(e){var i,o=e.lastIndexOf("."),r=e.split("/")[0],a="."===r||".."===r;return-1!==o&&(!a||o>1)&&(i=e.substring(o,e.length),e=e.substring(0,o)),w.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(P,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(P,e)||hasProp(M,e)}}),t||(r.undef=function(e){d();var n=a(e,t,!0),o=getOwn(M,e);i(e),delete P[e],delete E[n.url],delete A[e],o&&(o.events.defined&&(A[e]=o.events),l(e))}),r},enable:function(e){var t=getOwn(M,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,i,r=getOwn(C.shim,e)||{},a=r.exports;for(d();O.length;){if(n=O.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);p(n)}if(i=getOwn(M,e),!t&&!hasProp(P,e)&&i&&!i.inited){if(!(!C.enforceDefine||a&&getGlobal(a)))return o(e)?void 0:c(makeError("nodefine","No define call for "+e,null,[e]));p([e,r.deps||[],r.exportsFn])}h()},nameToUrl:function(e,t,n){var i,o,r,a,s,u,c,d,l;if(req.jsExtRegExp.test(e))d=e+(t||"");else{for(i=C.paths,o=C.pkgs,s=e.split("/"),u=s.length;u>0;u-=1){if(c=s.slice(0,u).join("/"),r=getOwn(o,c),l=getOwn(i,c)){isArray(l)&&(l=l[0]),s.splice(0,u,l);break}if(r){a=e===r.name?r.location+"/"+r.main:r.location,s.splice(0,u,a);break}}d=s.join("/"),d+=t||(/^data\:|\?/.test(d)||n?"":".js"),d=("/"===d.charAt(0)||d.match(/^[\w\+\.\-]+:/)?"":C.baseUrl)+d}return C.urlArgs?d+((-1===d.indexOf("?")?"?":"&")+C.urlArgs):d},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return o(t.id)?void 0:c(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var o,r,a=defContextName;return isArray(e)||"string"==typeof e||(r=e,isArray(t)?(e=t,t=n,n=i):e=[]),r&&r.context&&(a=r.context),o=getOwn(contexts,a),o||(o=contexts[a]=req.s.newContext(a)),r&&o.configure(r),o.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,n){var i,o=e&&e.config||{};if(isBrowser)return i=req.createNode(o,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(r){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,r,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var i,o;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(e,t){"use strict";function n(e){return document.createElement(e)}function i(e,t){for(var n in t)try{e.style[n]=t[n]}catch(i){}return e}function o(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}function r(e,t){if("array"!==o(t))return-1;if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1}function a(){var e=arguments;for(var t in e[1])if(e[1].hasOwnProperty(t))switch(o(e[1][t])){case"object":e[0][t]=a({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return e.length>2?a.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function s(e,t,n){var i,o,r,a,s,c,d,l,f;return a=.5>=n?n*(1+t):n+t-n*t,0===a?"#000":(s=2*n-a,c=(a-s)/a,e=6*e,d=Math.floor(e),l=e-d,f=a*c*l,0===d||6===d?(i=a,o=s+f,r=s):1===d?(i=a-f,o=a,r=s):2===d?(i=s,o=a,r=s+f):3===d?(i=s,o=a-f,r=a):4===d?(i=s+f,o=s,r=a):(i=a,o=s,r=a-f),"#"+u(i)+u(o)+u(r))}function u(e){return e=Math.round(255*e).toString(16),1===e.length?"0"+e:e}function c(e,t,n,i){e.addEventListener?e[i?"removeEventListener":"addEventListener"](t,n,!1):e.attachEvent&&e[i?"detachEvent":"attachEvent"]("on"+t,n)}function d(e,u){function v(){for(H=q.history;H--;)X[H]=0===H?B.fps:X[H-1],Y[H]=0===H?B.duration:Y[H-1]}function b(e,t,n,i){return P[0|e][Math.round(Math.min((t-n)/(i-n)*R,R))]}function y(){N.legend.fps!==J&&(N.legend.fps=J,N.legend[p]=J?"FPS":"ms"),j=J?B.fps:B.duration,N.count[p]=j>999?"999+":j.toFixed(j>99?0:q.decimals)}function w(){if(E=l(),U<E-q.threshold&&(B.fps-=B.fps/Math.max(1,60*q.smoothing/q.interval),B.duration=1e3/B.fps),v(),y(),q.heat){if(F.length)for(H=F.length;H--;)F[H].el.style[O[F[H].name].heatOn]=J?b(O[F[H].name].heatmap,B.fps,0,q.maxFps):b(O[F[H].name].heatmap,B.duration,q.threshold,0);if(N.graph&&O.column.heatOn)for(H=L.length;H--;)L[H].style[O.column.heatOn]=J?b(O.column.heatmap,X[H],0,q.maxFps):b(O.column.heatmap,Y[H],q.threshold,0)}if(N.graph)for(D=0;D<q.history;D++)L[D].style.height=(J?X[D]?Math.round(T/q.maxFps*Math.min(X[D],q.maxFps)):0:Y[D]?Math.round(T/q.threshold*Math.min(Y[D],q.threshold)):0)+"px"}function x(){q.interval<20?(I=h(x),w()):(I=setTimeout(x,q.interval),k=h(w))}function _(e){e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0),B.toggle()}function C(){q.toggleOn&&c(N.container,q.toggleOn,_,1),e.removeChild(N.container)}function M(){if(O=d.theme[q.theme],P=O.compiledHeatmaps||[],!P.length&&O.heatmaps.length){for(D=0;D<O.heatmaps.length;D++)for(P[D]=[],H=0;R>=H;H++)P[D][H]=s(.33/R*H,O.heatmaps[D].saturation,O.heatmaps[D].lightness);O.compiledHeatmaps=P}}function S(){N.container&&C(),M(),N.container=i(n("div"),O.container),N.count=N.container.appendChild(i(n("div"),O.count)),N.legend=N.container.appendChild(i(n("div"),O.legend)),N.graph=q.graph?N.container.appendChild(i(n("div"),O.graph)):0,F.length=0;for(var t in N)N[t]&&O[t].heatOn&&F.push({name:t,el:N[t]});if(L.length=0,N.graph)for(N.graph.style.width=q.history*O.column.width+(q.history-1)*O.column.spacing+"px",H=0;H<q.history;H++)L[H]=N.graph.appendChild(i(n("div"),O.column)),L[H].style.position="absolute",L[H].style.bottom=0,L[H].style.right=H*O.column.width+H*O.column.spacing+"px",L[H].style.width=O.column.width+"px",L[H].style.height="0px";A(),y(),e.appendChild(N.container),N.graph&&(T=N.graph.clientHeight),q.toggleOn&&("click"===q.toggleOn&&(N.container.style.cursor="pointer"),c(N.container,q.toggleOn,_))}function A(){i(N.container,q)}"object"===o(e)&&e.nodeType===t&&(u=e,e=document.body),e||(e=document.body);var O,P,E,I,k,T,j,H,D,B=this,q=a({},d.defaults,u||{}),N={},L=[],R=100,F=[],z=0,W=q.threshold,G=0,U=l()-W,X=[],Y=[],J="fps"===q.show;B.options=q,B.fps=0,B.duration=0,B.isPaused=0,B.tickStart=function(){G=l()},B.tick=function(){E=l(),z=E-U,W+=(z-W)/q.smoothing,B.fps=1e3/W,B.duration=U>G?W:E-G,U=E},B.pause=function(){return I&&(B.isPaused=1,clearTimeout(I),f(I),f(k),I=k=0),B},B.resume=function(){return I||(B.isPaused=0,x()),B},B.set=function(e,t){return q[e]=t,J="fps"===q.show,-1!==r(e,g)&&S(),-1!==r(e,m)&&A(),B},B.showDuration=function(){return B.set("show","ms"),B},B.showFps=function(){return B.set("show","fps"),B
},B.toggle=function(){return B.set("show",J?"ms":"fps"),B},B.hide=function(){return B.pause(),N.container.style.display="none",B},B.show=function(){return B.resume(),N.container.style.display="block",B},B.destroy=function(){B.pause(),C(),B.tick=B.tickStart=function(){}},function(){S(),x()}()}var l;!function(){var t=e.performance;if(t&&(t.now||t.webkitNow)){var n=t.now?"now":"webkitNow";l=t[n].bind(t)}else l=function(){return+new Date}}();var f=e.cancelAnimationFrame||e.cancelRequestAnimationFrame,h=e.requestAnimationFrame;!function(){for(var t=["moz","webkit","o"],n=0,i=0,o=t.length;o>i&&!f;++i)f=e[t[i]+"CancelAnimationFrame"]||e[t[i]+"CancelRequestAnimationFrame"],h=f&&e[t[i]+"RequestAnimationFrame"];f||(h=function(t){var i=l(),o=Math.max(0,16-(i-n));return n=i+o,e.setTimeout(function(){t(i+o)},o)},f=function(e){clearTimeout(e)})}();var p="string"===o(document.createElement("div").textContent)?"textContent":"innerText";d.extend=a,window.FPSMeter=d,d.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var g=["toggleOn","theme","heat","graph","history"],m=["position","zIndex","left","top","right","bottom","margin"]}(window),function(e,t){"use strict";t.theme={};var n=t.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};t.theme.dark=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),t.theme.light=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),t.theme.colorful=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),t.theme.transparent=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),function(){"use strict";var e={require:window.require,define:window.define};window.bento=window.bento||e}(),define("bento",["bento/utils","bento/lib/domready","bento/managers/asset","bento/managers/input","bento/managers/object","bento/managers/audio","bento/managers/screen","bento/managers/savestate","bento/math/vector2","bento/math/rectangle","bento/renderer"],function(e,t,n,i,o,r,a,s,u,c,d){"use strict";var l,f,h,p=((new Date).getTime(),!0),g=0,m=!1,v={x:1,y:1},b={},y=c(0,0,640,480),w=function(t,n){var i;l=document.getElementById(t.canvasId),l||(i=document.getElementById("wrapper"),i||(i=document.body),l=document.createElement(e.isCocoonJS()?"screencanvas":"canvas"),l.id=t.canvasId,i.appendChild(l)),l.width=y.width,l.height=y.height,g=y.height/y.width,t.renderer=t.renderer||"auto","auto"===t.renderer&&(t.renderer="webgl",(e.isCocoonJS()||e.isAndroid())&&(t.renderer="canvas2d")),d(t.renderer,l,t,function(e){f=e,b={canvas:l,renderer:e,canvasScale:v,viewport:y,entity:null},n()})},x=function(){var e,t,n=window.innerWidth,i=window.innerHeight;m||(h=i/n,g>h?(e=i/g,t=i):(e=n,t=n*g),p?(l.style.width=e+"px",l.style.height=t+"px"):(l.width=e,l.height=t),v.x=e/y.width,v.y=t/y.height)},_={setup:function(s,u){t(function(){var t=function(){_.objects.run(),u&&u()};if(s.canvasDimension){if(!s.canvasDimension.isRectangle)throw"settings.canvasDimension must be a rectangle";y=s.canvasDimension||y}w(s,function(){m=s.manualResize,window.addEventListener("resize",x,!1),window.addEventListener("orientationchange",x,!1),x(),_.input=i(b),_.objects=o(b,s),_.assets=n(),_.audio=r(_),_.screens=a(),e.extend(_,_.objects),s.assetGroups?_.assets.loadAssetGroups(s.assetGroups,t):t()})})},getViewport:function(){return y},getCanvas:function(){return l},getRenderer:function(){return f},getGameData:function(){return{canvas:l,renderer:f,canvasScale:v,viewport:y,entity:null}},assets:null,objects:null,input:null,audio:null,screens:null,saveState:s,utils:e};return _}),bento.define("bento/color",["bento/utils"],function(e){return function(t,n,i,o){return t/=255,t=n/255,t=i/255,e.isDefined(o)||(o=1),[t,n,i,o]}}),bento.define("bento/entity",["bento","bento/utils","bento/math/vector2","bento/math/rectangle"],function(e,t,n,i){"use strict";var o=0;return function(r){var a,s,u=!0,c=n(0,0),d=(n(0,0),n(0,0)),l=i(0,0,0,0),f=[],h=[],p=null,g=++o,m=function(){var e;for(e=f.length-1;e>=0;--e)f[e]||f.splice(e,1)},v={z:0,timer:0,global:!1,"float":!1,updateWhenPaused:!1,name:"",isAdded:!1,useHshg:!1,start:function(e){var t,n,i;for(e&&(e.entity=this),t=0,n=f.length;n>t;++t)i=f[t],i&&i.start&&i.start(e)},destroy:function(e){var t,n,i;for(e&&(e.entity=this),t=0,n=f.length;n>t;++t)i=f[t],i&&i.destroy&&i.destroy(e)},update:function(e){var t,n,i;for(e&&(e.entity=this),t=0,n=f.length;n>t;++t)i=f[t],i&&i.update&&i.update(e);++v.timer,m()},draw:function(e){var t,n,i;if(u){for(e&&(e.entity=this),t=0,n=f.length;n>t;++t)i=f[t],i&&i.draw&&i.draw(e);for(t=f.length-1;t>=0;t--)i=f[t],i&&i.postDraw&&i.postDraw(e)}},addToFamily:function(e){h.push(e)},getFamily:function(){return h},extend:function(e){return t.extend(v,e)},getPosition:function(){return c},setPosition:function(e){c.x=e.x,c.y=e.y},setPositionX:function(e){c.x=e},setPositionY:function(e){c.y=e},getDimension:function(){return l},setDimension:function(e){l=e},getBoundingBox:function(){var e,t,o,r,a,u;return s?(u=s.clone(),e=v.scale?v.scale.getScale():n(1,1),u.x*=Math.abs(e.x),u.y*=Math.abs(e.y),u.width*=Math.abs(e.x),u.height*=Math.abs(e.y),u.x+=c.x,u.y+=c.y,u):(e=v.scale?v.scale.getScale():n(1,1),t=c.x-d.x*e.x,r=c.y-d.y*e.y,o=c.x+(l.width-d.x)*e.x,a=c.y+(l.height-d.y)*e.y,e.x<0&&(o=[t,t=o][0]),e.y<0&&(a=[r,r=a][0]),i(t,r,o-t,a-r))},setBoundingBox:function(e){s=e},getRectangle:function(){return s},setOrigin:function(e){d.x=e.x,d.y=e.y},setOriginRelative:function(e){d.x=e.x*l.width,d.y=e.y*l.height},getOrigin:function(){return d},isVisible:function(){return u},setVisible:function(e){u=e},attached:function(e){var t,n,i;for(e?e.entity=this:e={entity:v},t=0,n=f.length;n>t;++t)if(i=f[t]){if(i.getParent)continue;i.attached&&i.attached(e)}},attach:function(e,n){var i={},o=v;if(f.push(e),e.setParent&&e.setParent(v),e.init&&e.init(),e.attached&&e.attached({entity:v}),v.isAdded)e.start&&e.start();else for(o.getParent&&(o=o.getParent());o;)o.isAdded&&e.start&&e.start(),o=o.getParent();return n&&(i[n]=e,t.extend(v,i)),v},remove:function(e){var t;if(e)return t=f.indexOf(e),t>=0&&(e.destroy&&e.destroy(),f[t]=null),v},getComponents:function(){return f},getComponentByName:function(e){var t,n,i;for(t=0,n=f.length;n>t;++t)if(i=f[t],i.name===e)return i},getComponentIndex:function(e){return f.indexOf(e)},moveComponentTo:function(e,t){var n;e&&(n=f.indexOf(e),n>=0&&(f.splice(n,1),f.splice(t,0,e)))},setParent:function(e){p=e},getParent:function(){return p},getId:function(){return g},collidesWith:function(e,i,o){var r;return t.isDefined(i)||(i=n(0,0)),r=v.getBoundingBox().offset(i).intersect(e.getBoundingBox()),r&&o&&o(e),r},collidesWithGroup:function(e,i,o){var r,a,s;if(t.isDefined(i)||(i=n(0,0)),!t.isArray(e))return void console.log("Collision check must be with an Array of object");if(!e.length)return null;for(s=v.getBoundingBox().offset(i),r=0;r<e.length;++r)if(a=e[r],a!==v&&a.getBoundingBox&&s.intersect(a.getBoundingBox()))return o&&o(a),a;return null},getAABB:function(){var e=v.getBoundingBox();return{min:[e.x,e.y],max:[e.x+e.width,e.y+e.height]}}};if(r){if(r.components)for(t.isArray(r.components)||(r.components=[r.components]),a=0;a<r.components.length;++a)r.components[a](v,r);if(r.position&&v.setPosition(r.position),r.origin&&v.setOrigin(r.origin),r.originRelative&&v.setOriginRelative(r.originRelative),r.name&&(v.name=r.name),r.family)for(t.isArray(r.family)||(r.family=[r.family]),a=0;a<r.family.length;++a)v.addToFamily(r.family[a]);r.init&&r.init.apply(v),v.z=r.z||0,v.updateWhenPaused=r.updateWhenPaused||!1,v.global=r.global||!1,v["float"]=r["float"]||!1,v.useHshg=r.useHshg||!1,v.staticHshg=r.staticHshg||!1,v.onCollide=r.onCollide,r.addNow&&e.objects.add(v)}return v}}),bento.define("bento/eventsystem",["bento/utils"],function(e){var t={},n=[],i=function(){var i,o,r,a,s;for(o=0;o<n.length;o+=1)if(a=n[o].eventName,s=n[o].callback,!e.isUndefined(t[a]))for(r=t[a],i=r.length-1;i>=0;i-=1)if(r[i]===s){r.splice(i,1);break}n=[]},o=function(n,i){e.isUndefined(t[n])&&(t[n]=[]),t[n].push(i)},r=function(e,t){n.push({eventName:e,callback:t})};return{fire:function(n,o){var r,a,s,u;if(i(),e.isString(n)||(n=n.toString()),!e.isUndefined(t[n]))for(s=t[n],r=0,a=s.length;a>r;++r)u=s[r],u?u(o):console.log("Warning: listener is not a function:",u,r)},addEventListener:o,removeEventListener:r,on:o,off:r}}),bento.define("bento/packedimage",["bento/math/rectangle"],function(e){return function(t,n){var i=n?e(n.x,n.y,n.w,n.h):e(0,0,t.width,t.height);return i.image=t,i}}),bento.define("bento/renderer",["bento/utils"],function(e){return function(t,n,i,o){var r={save:function(){},restore:function(){},translate:function(){},scale:function(){},rotate:function(){},fillRect:function(){},fillCircle:function(){},strokeRect:function(){},drawImage:function(){},begin:function(){},flush:function(){},setColor:function(){},getOpacity:function(){},setOpacity:function(){},createSurface:function(){},setContext:function(){},restoreContext:function(){}};require(["bento/renderers/"+t],function(t){e.extend(r,t(n,i)),o(r)})}}),bento.define("bento/utils",[],function(){"use strict";var e,t=function(e){return"string"==typeof e||e instanceof String},n=Array.prototype.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=function(e){return"[object Object]"===Object.prototype.toString.call(e)},o=function(e){return"[object Function]"===Object.prototype.toString.call(e)},r=function(e){return"[object Number]"===Object.prototype.toString.call(e)},a=function(e){return e===!0||e===!1||"[object Boolean]"===Object.prototype.toString.call(e)},s=function(e){return parseFloat(e)===parseInt(e,10)&&!isNaN(e)},u=function(e){return void 0===e},c=function(e){return void 0!==e},d=function(e,t){var n,i;for(n=0,i=e.length;i>n;n+=1)if(e[n]===t){e.splice(n,1);break}},l=function(e,t,n){var o,r;for(o in t)t.hasOwnProperty(o)&&(e.hasOwnProperty(o)&&!n&&(e.base=e.base||{},r={},r[o]=e[o],l(e.base,r)),e[o]=i(t[o])?l({},t[o]):t[o]);return e},f=function(e){return Object.keys(e).length},h=function(){var e=function(e,n){return t(e.slice(),n)},t=function(e,t){"function"!=typeof t&&(t=function(e,t){return String(e).localeCompare(t)});var i=e.length;if(1>=i)return e;for(var o=new Array(i),r=1;i>r;r*=2){n(e,t,r,o);var a=e;e=o,o=a}return e},n=function(e,t,n,i){var o,r,a,s,u,c=e.length,d=0,l=2*n;for(o=0;c>o;o+=l)for(r=o+n,a=r+n,r>c&&(r=c),a>c&&(a=c),s=o,u=r;;)if(r>s&&a>u)i[d++]=t(e[s],e[u])<=0?e[s++]:e[u++];else if(r>s)i[d++]=e[s++];else{if(!(a>u))break;i[d++]=e[u++]}};return e.inplace=function(e,i){var o=t(e,i);return o!==e&&n(o,null,e.length,e),e},e}(),p=function(){var e,t={3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdivide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]};for(e=65;90>=e;e+=1)t[e]=String.fromCharCode(e+32);return t}();return e={isString:t,isArray:n,isObject:i,isFunction:o,isNumber:r,isBoolean:a,isInt:s,isUndefined:u,isDefined:c,removeObject:d,extend:l,getKeyLength:f,stableSort:h,keyboardMapping:p,getRandom:function(e){return Math.floor(Math.random()*e)},toRadian:function(e){return e*Math.PI/180},sign:function(e){return e>0?1:0>e?-1:0},approach:function(e,t,n){return t>e?Math.min(e+n,t):Math.max(e-n,t)},isApple:function(){var e=navigator.userAgent.match(/iPhone|iPad|iPod/i);return/iPhone/i.test(e)||/iPad/i.test(e)||/iPod/i.test(e)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isCocoonJS:function(){return navigator.isCocoonJS}}}),bento.define("bento/components/animation",["bento","bento/utils"],function(e,t){"use strict";return function(n,i){var o,r,a,s,u={},c={},d=0,l=1,f=1,h=0,p=0,g=n.getOrigin(),m={name:"animation",setup:function(t){if(r=t?t:{frameCountX:1,frameCountY:1},r.animations||(r.animations={}),r.animations["default"]||(r.animations["default"]={frames:[0]}),t.image)o=t.image;else{if(!t.imageName)return;if(!e.assets)throw"Bento asset manager not loaded";o=e.assets.getImage(t.imageName)}r.frameWidth?(h=r.frameWidth,l=Math.floor(o.width/h)):(l=r.frameCountX||1,h=o.width/l),r.frameHeight?(p=r.frameHeight,f=Math.floor(o.height/p)):(f=r.frameCountY||1,p=o.height/f),n.getDimension().width=h,n.getDimension().height=p,u=r.animations,a=u["default"]},setAnimation:function(e,n,i){var o=u[e];return o?void(o&&a!==o&&(t.isDefined(o.loop)||(o.loop=!0),t.isDefined(o.backTo)||(o.backTo=0),s=n,a=o,a.name=e,i||(d=0))):void console.log("Warning: animation "+e+" does not exist.")},getAnimation:function(){return a?a.name:null},setFrame:function(e){d=e},setCurrentSpeed:function(e){a.speed=e},getCurrentFrame:function(){return d},getFrameWidth:function(){return h},update:function(){var e;if(a){if(e=!1,d+=a.speed||1,a.loop)for(;d>=a.frames.length;)d-=a.frames.length-a.backTo,e=!0;else d>=a.frames.length&&(e=!0);e&&s&&s()}},draw:function(e){var t,n,i;a&&(t=Math.min(Math.floor(d),a.frames.length-1),n=a.frames[t]%l*h,i=Math.floor(a.frames[t]/l)*p,e.renderer.translate(Math.round(-g.x),Math.round(-g.y)),e.renderer.drawImage(o,n,i,h,p,0,0,h,p),e.renderer.translate(Math.round(g.x),Math.round(g.y)))}};return i&&i[m.name]&&m.setup(i[m.name]),n.attach(m),c[m.name]=m,t.extend(n,c),n}}),bento.define("bento/components/clickable",["bento","bento/utils","bento/math/vector2","bento/math/matrix","bento/eventsystem"],function(e,t,n,i,o){"use strict";return function(n,r){var a={},s=!1,u=!1,c={name:"clickable",isHovering:!1,hasTouched:!1,holdId:null,pointerDown:function(){},pointerUp:function(){},pointerMove:function(){},onClick:function(){},onClickUp:function(){},onClickMiss:function(){},onHold:function(){},onHoldLeave:function(){},onHoldEnter:function(){},onHoldEnd:function(){},onHoverLeave:function(){},onHoverEnter:function(){},destroy:function(){o.removeEventListener("pointerDown",l),o.removeEventListener("pointerUp",f),o.removeEventListener("pointerMove",h),u=!1},start:function(){u||(o.addEventListener("pointerDown",l),o.addEventListener("pointerUp",f),o.addEventListener("pointerMove",h),u=!0)},update:function(){this.isHovering&&s&&this.onHold&&this.onHold()}},d=function(e){return{id:e.id,position:e.position.clone(),eventType:e.eventType,localPosition:e.localPosition.clone(),worldPosition:e.worldPosition.clone()}},l=function(t){var i=g(t);e.objects&&e.objects.isPaused()&&!n.updateWhenPaused||(s=!0,c.pointerDown&&c.pointerDown(i),n.getBoundingBox&&p(i,!0))},f=function(t){var i,o=g(t);e.objects&&e.objects.isPaused()&&!n.updateWhenPaused||(i=o.localPosition,s=!1,c.pointerUp&&c.pointerUp(o),n.getBoundingBox().hasPosition(i)&&(c.onClickUp(o),c.hasTouched&&c.holdId===o.id&&(c.holdId=null,c.onHoldEnd(o))),c.hasTouched=!1)},h=function(t){var i=g(t);e.objects&&e.objects.isPaused()&&!n.updateWhenPaused||(c.pointerMove&&c.pointerMove(i),n.getBoundingBox&&p(i))},p=function(e,t){var i=e.localPosition;n.getBoundingBox().hasPosition(i)?(c.hasTouched&&!c.isHovering&&c.holdId===e.id&&c.onHoldEnter(e),c.isHovering||c.onHoverEnter(e),c.isHovering=!0,t&&(c.hasTouched=!0,c.holdId=e.id,c.onClick(e))):(c.hasTouched&&c.isHovering&&c.holdId===e.id&&c.onHoldLeave(e),c.isHovering&&c.onHoverLeave(e),c.isHovering=!1,t&&c.onClickMiss(e))},g=function(e){var t,o,r,a,s,u,c=i(3,3),l=i(3,3),f=i(3,3),h=[];if(!n.getParent||!n.getParent())return e.localPosition=n["float"]?e.position.clone():e.worldPosition.clone(),e;for(e=d(e),t=n["float"]?e.localPosition.toMatrix():e.worldPosition.toMatrix(),s=n;s.getParent&&s.getParent();)s=s.getParent(),h.unshift(s);for(u=0;u<h.length;++u)s=h[u],s.getPosition&&(a=s.getPosition(),c.set(2,0,-a.x),c.set(2,1,-a.y),t.multiplyWith(c)),s.rotation&&(o=Math.sin(-s.rotation.getAngleRadian()),r=Math.cos(-s.rotation.getAngleRadian()),f.set(0,0,r),f.set(1,0,-o),f.set(0,1,o),f.set(1,1,r),t.multiplyWith(f)),s.scale&&(l.set(0,0,1/s.scale.getScale().x),l.set(1,1,1/s.scale.getScale().y),t.multiplyWith(l));return e.localPosition.x=t.get(0,0),e.localPosition.y=t.get(0,1),e};return r&&r[c.name]&&(r=r[c.name],t.extend(c,r)),n.attach(c),a[c.name]=c,t.extend(n,a),n}}),bento.define("bento/components/fill",["bento/utils","bento"],function(e,t){"use strict";return function(n,i){var o=t.getViewport(),r={},a=[0,0,0,1],s={name:"fill",draw:function(e){e.renderer.fillRect(a,0,0,o.width,o.height)},setup:function(e){a=e.color}};return i&&i[s.name]&&s.setup(i[s.name]),n.attach(s),r[s.name]=s,e.extend(n,r),n}}),bento.define("bento/components/opacity",["bento/utils","bento/math/vector2"],function(e){"use strict";return function(t){var n=1,i=!1,o=1,r={},a={name:"opacity",draw:function(e){i&&(o=e.renderer.getOpacity(),e.renderer.setOpacity(n))},postDraw:function(e){e.renderer.setOpacity(o)},setOpacity:function(e){i=!0,n=e},getOpacity:function(){return n}};return t.attach(a),r[a.name]=a,e.extend(t,r),t}}),bento.define("bento/components/pixi",["bento","bento/utils"],function(e,t){"use strict";return window.PIXI?function(n,i){var o,r,a,s,u,c,d,l={},f={},h=0,p=1,g=1,m=0,v=0,b=e.getViewport(),y={name:"pixi",setup:function(t){var i;if(s=t?t:{frameCountX:1,frameCountY:1},s.animations||(s.animations={}),s.animations["default"]||(s.animations["default"]={frames:[0]}),t.image)c=t.image;else{if(!t.imageName)return;if(!e.assets)throw"Bento asset manager not loaded";c=e.assets.getImage(t.imageName)}s.frameWidth?(m=s.frameWidth,p=Math.floor(c.width/m)):(p=s.frameCountX||1,m=c.width/p),s.frameHeight?(v=s.frameHeight,g=Math.floor(c.height/v)):(g=s.frameCountY||1,v=c.height/g),n.getDimension().width=m,n.getDimension().height=v,l=s.animations,u=l["default"],o=new PIXI.BaseTexture(c.image,PIXI.SCALE_MODES.NEAREST),i=new PIXI.Rectangle(c.x,c.y,m,v),r=new PIXI.Texture(o,i),a=new PIXI.Sprite(r)},update:function(){var e;if(u){if(e=!1,h+=u.speed||1,u.loop)for(;h>=u.frames.length;)h-=u.frames.length-u.backTo,e=!0;else h>=u.frames.length&&(e=!0);e&&d&&d(),a.visible=n.isVisible()}},draw:function(){var e,t,i,o,s,d,l=n.getOrigin(),f=n.getPosition();u&&(o=Math.min(Math.floor(h),u.frames.length-1),s=u.frames[o]%p*m,d=Math.floor(u.frames[o]/p)*v,i=new PIXI.Rectangle(c.x+s,c.y+d,m,v),r.frame=i,a.x=f.x,a.y=f.y,a.anchor.x=l.x/m,a.anchor.y=l.y/v,n["float"]&&(a.x-=b.x,a.y-=b.y),n.scale&&(t=n.scale.getScale(),a.scale.x=t.x,a.scale.y=t.y),n.rotation&&(e=n.rotation.getAngleRadian(),a.rotation=e),n.opacity&&(a.alpha=n.opacity.getOpacity()))},destroy:function(e){e.renderer.removeChild(a)},start:function(){return a?void 0:void console.log("call setup first")},attached:function(e){var t,n;e.renderer?e.renderer.addChild(a):e.entity&&(t=e.entity.getParent(),t&&(n=t.getComponentByName("pixi"),n&&n.getPixiSprite().addChild(a)))},getPixiSprite:function(){return a},setAnimation:function(e,n,i){var o=l[e];return o?void(o&&u!==o&&(t.isDefined(o.loop)||(o.loop=!0),t.isDefined(o.backTo)||(o.backTo=0),d=n,u=o,u.name=e,i||(h=0))):void console.log("Warning: animation "+e+" does not exist.")},getAnimation:function(){return u?u.name:null},setFrame:function(e){h=e},setCurrentSpeed:function(e){u.speed=e},getCurrentFrame:function(){return h},getFrameWidth:function(){return m}};return i&&i[y.name]&&y.setup(i[y.name]),n.attach(y),f[y.name]=y,t.extend(n,f),n}:(console.log("Warning: PIXI is not available"),function(){})}),bento.define("bento/components/rotation",["bento/utils"],function(e){"use strict";return function(t){var n,i={},o={name:"rotation",draw:function(e){n&&e.renderer.rotate(n)},postDraw:function(){},addAngleDegree:function(e){n||(n=0),n+=e*Math.PI/180},addAngleRadian:function(e){n||(n=0),n+=e},setAngleDegree:function(e){n=e*Math.PI/180},setAngleRadian:function(e){n=e},getAngleDegree:function(){return n?180*n/Math.PI:0},getAngleRadian:function(){return n?n:0}};return t.attach(o),i[o.name]=o,e.extend(t,i),t}}),bento.define("bento/components/scale",["bento/utils","bento/math/vector2"],function(e,t){"use strict";return function(n){var i=!1,o=t(1,1),r={},a={name:"scale",draw:function(e){i&&e.renderer.scale(o.x,o.y)},setScale:function(e){i=!0,o=e},getScale:function(){return o},setScaleX:function(e){i=!0,o.x=e},setScaleY:function(e){i=!0,o.y=e}};return n.attach(a),r[a.name]=a,e.extend(n,r),n}}),bento.define("bento/components/sprite",["bento","bento/utils","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/opacity","bento/components/animation","bento/components/pixi"],function(e,t,n,i,o,r,a,s){"use strict";var u;return function(c,d){return u||(u=e.getRenderer()),n(c,d),o(c,d),i(c,d),r(c,d),"pixi"===u.name?(d.sprite&&(d.pixi=d.sprite),s(c,d),c.sprite=c.pixi):(d.sprite&&(d.animation=d.sprite),a(c,d),c.sprite=c.animation),t.extend(c.sprite,c.scale),t.extend(c.sprite,c.rotation),t.extend(c.sprite,c.opacity),c}}),bento.define("bento/components/translation",["bento/utils","bento/math/vector2"],function(e){"use strict";return function(t){var n={},i=!1,o={name:"translation",setSubPixel:function(e){i=e},draw:function(e){var n=t.getParent(),o=t.getPosition(),r=(t.getOrigin(),e.viewport);e.renderer.save(t),i?e.renderer.translate(o.x,o.y):e.renderer.translate(Math.round(o.x),Math.round(o.y)),null!==n||t["float"]||e.renderer.translate(Math.round(-r.x),Math.round(-r.y))},postDraw:function(e){e.renderer.restore()}};return t.attach(o),n[o.name]=o,e.extend(t,n),t}}),bento.define("bento/lib/domready",[],function(){"use strict";function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=d;u&&t.length&&(d=[],e(t))}function n(){u||(u=!0,a&&clearInterval(a),t())}function i(e){return u?e(c):d.push(e),i}var o,r,a,s="undefined"!=typeof window&&window.document,u=!s,c=s?document:null,d=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),r=document.createElement("div");try{o=null===window.frameElement}catch(l){}r.doScroll&&o&&window.external&&(a=setInterval(function(){try{r.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(e,t,n,o){o.isBuild?n(null):i(n)},i}),bento.define("hshg",[],function(){function e(){var e,t,n,i,o,r;for(e=0;e<this._globalObjects.length;e++)t=this._globalObjects[e],i=t.HSHG,n=i.grid,o=t.getAABB(),r=n.toHash(o.min[0],o.min[1]),r!==i.hash&&(n.removeObject(t),n.addObject(t,r))}function t(){}function n(e,t){var n=e.getAABB(),i=t.getAABB();return n.min[0]>i.max[0]||n.min[1]>i.max[1]||n.max[0]<i.min[0]||n.max[1]<i.min[1]?!1:!0}function i(e,t){return Math.max(Math.abs(t[0]-e[0]),Math.abs(t[1]-e[1]))}function o(){this.MAX_OBJECT_CELL_DENSITY=1/8,this.INITIAL_GRID_LENGTH=256,this.HIERARCHY_FACTOR=2,this.HIERARCHY_FACTOR_SQRT=Math.SQRT2,this.UPDATE_METHOD=e,this._grids=[],this._globalObjects=[]}function r(e,t,n){this.cellSize=e,this.inverseCellSize=1/e,this.rowColumnCount=~~Math.sqrt(t),this.xyHashMask=this.rowColumnCount-1,this.occupiedCells=[],this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.allObjects=[],this.sharedInnerOffsets=[],this._parentHierarchy=n||null}function a(){this.objectContainer=[],this.neighborOffsetArray,this.occupiedCellsIndex=null,this.allCellsIndex=null}return o.prototype.addObject=function(e){var t,n,o,a,s,u=e.getAABB(),c=i(u.min,u.max);if(e.HSHG={globalObjectsIndex:this._globalObjects.length},this._globalObjects.push(e),0==this._grids.length)o=c*this.HIERARCHY_FACTOR_SQRT,s=new r(o,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(e),this._grids.push(s);else{for(t=0,n=0;n<this._grids.length;n++)if(a=this._grids[n],t=a.cellSize,t>c){if(t/=this.HIERARCHY_FACTOR,t>c){for(;t>c;)t/=this.HIERARCHY_FACTOR;s=new r(t*this.HIERARCHY_FACTOR,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(e),this._grids.splice(n,0,s)}else a.addObject(e);return}for(;c>=t;)t*=this.HIERARCHY_FACTOR;s=new r(t,this.INITIAL_GRID_LENGTH,this),s.initCells(),s.addObject(e),this._grids.push(s)}},o.prototype.removeObject=function(e){var t,n,i=e.HSHG;void 0!==i&&(t=i.globalObjectsIndex,t===this._globalObjects.length-1?this._globalObjects.pop():(n=this._globalObjects.pop(),n.HSHG.globalObjectsIndex=t,this._globalObjects[t]=n),i.grid.removeObject(e),delete e.HSHG)},o.prototype.update=function(){this.UPDATE_METHOD.call(this)},o.prototype.queryForCollisionPairs=function(e){var t,i,o,r,a,s,u,c,d,l,f,h,p,g,m=[];for(broadOverlapTest=e||n,t=0;t<this._grids.length;t++){for(s=this._grids[t],i=0;i<s.occupiedCells.length;i++){for(u=s.occupiedCells[i],o=0;o<u.objectContainer.length;o++)if(c=u.objectContainer[o],!c.staticHshg)for(r=o+1;r<u.objectContainer.length;r++)d=u.objectContainer[r],broadOverlapTest(c,d)===!0&&m.push([c,d]);for(a=0;4>a;a++)for(l=u.neighborOffsetArray[a],f=s.allCells[u.allCellsIndex+l],o=0;o<u.objectContainer.length;o++)if(c=u.objectContainer[o],!c.staticHshg)for(r=0;r<f.objectContainer.length;r++)d=f.objectContainer[r],broadOverlapTest(c,d)===!0&&m.push([c,d])}for(i=0;i<s.allObjects.length;i++)if(c=s.allObjects[i],!c.staticHshg)for(p=c.getAABB(),o=t+1;o<this._grids.length;o++)for(h=this._grids[o],g=h.toHash(p.min[0],p.min[1]),u=h.allCells[g],a=0;a<u.neighborOffsetArray.length;a++)for(l=u.neighborOffsetArray[a],f=h.allCells[u.allCellsIndex+l],r=0;r<f.objectContainer.length;r++)d=f.objectContainer[r],broadOverlapTest(c,d)===!0&&m.push([c,d])}for(t=0;t<m.length;++t)m[t][0].onCollide&&m[t][0].onCollide(m[t][1]),m[t][1].onCollide&&m[t][1].onCollide(m[t][0]);return m},o.update_RECOMPUTE=e,o.update_REMOVEALL=t,r.prototype.initCells=function(){var e,t,n,i,o,r,s,u,c,d,l,f,h=this.allCells.length,p=this.rowColumnCount,g=[p-1,p,p+1,-1,0,1,-1+-p,-p,-p+1],m=[];for(this.sharedInnerOffsets=g,e=0;h>e;e++)f=new a,n=~~(e/this.rowColumnCount),t=~~(e-n*this.rowColumnCount),i=!1,o=!1,r=!1,s=!1,(t+1)%this.rowColumnCount==0?i=!0:t%this.rowColumnCount==0&&(o=!0),(n+1)%this.rowColumnCount==0?r=!0:n%this.rowColumnCount==0&&(s=!0),i||o||r||s?(c=i===!0?-p+1:1,u=o===!0?p-1:-1,d=r===!0?-h+p:p,l=s===!0?h-p:-p,m=[u+d,d,c+d,u,0,c,u+l,l,c+l],f.neighborOffsetArray=m):f.neighborOffsetArray=this.sharedInnerOffsets,f.allCellsIndex=e,this.allCells[e]=f},r.prototype.toHash=function(e,t){var n,i,o;return 0>e?(n=-e*this.inverseCellSize,i=this.rowColumnCount-1-(~~n&this.xyHashMask)):(n=e*this.inverseCellSize,i=~~n&this.xyHashMask),0>t?(n=-t*this.inverseCellSize,o=this.rowColumnCount-1-(~~n&this.xyHashMask)):(n=t*this.inverseCellSize,o=~~n&this.xyHashMask),i+o*this.rowColumnCount},r.prototype.addObject=function(e,t){var n,i,o;void 0!==t?i=t:(n=e.getAABB(),i=this.toHash(n.min[0],n.min[1])),o=this.allCells[i],0===o.objectContainer.length&&(o.occupiedCellsIndex=this.occupiedCells.length,this.occupiedCells.push(o)),e.HSHG.objectContainerIndex=o.objectContainer.length,e.HSHG.hash=i,e.HSHG.grid=this,e.HSHG.allGridObjectsIndex=this.allObjects.length,o.objectContainer.push(e),this.allObjects.push(e),this.allObjects.length/this.allCells.length>this._parentHierarchy.MAX_OBJECT_CELL_DENSITY&&this.expandGrid()},r.prototype.removeObject=function(e){var t,n,i,o,r,a,s=e.HSHG;t=s.hash,n=s.objectContainerIndex,i=s.allGridObjectsIndex,o=this.allCells[t],1===o.objectContainer.length?(o.objectContainer.length=0,o.occupiedCellsIndex===this.occupiedCells.length-1?this.occupiedCells.pop():(r=this.occupiedCells.pop(),r.occupiedCellsIndex=o.occupiedCellsIndex,this.occupiedCells[o.occupiedCellsIndex]=r),o.occupiedCellsIndex=null):n===o.objectContainer.length-1?o.objectContainer.pop():(a=o.objectContainer.pop(),a.HSHG.objectContainerIndex=n,o.objectContainer[n]=a),i===this.allObjects.length-1?this.allObjects.pop():(a=this.allObjects.pop(),a.HSHG.allGridObjectsIndex=i,this.allObjects[i]=a)},r.prototype.expandGrid=function(){{var e,t=this.allCells.length,n=(this.rowColumnCount,this.xyHashMask,4*t),i=~~Math.sqrt(n),o=i-1,r=this.allObjects.slice(0);Array.prototype.push}for(e=0;e<r.length;e++)this.removeObject(r[e]);for(this.rowColumnCount=i,this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.xyHashMask=o,this.initCells(),e=0;e<r.length;e++)this.addObject(r[e])},o._private={Grid:r,Cell:a,testAABBOverlap:n,getLongestAABBEdge:i},o}),bento.define("bento/lib/requestanimationframe",[],function(){"use strict";for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),o=window.setTimeout(function(){t(n+i)},i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)}),window.requestAnimationFrame}),bento.define("bento/managers/asset",["bento/packedimage","bento/utils"],function(e,t){"use strict";return function(){var n={},i="",o={audio:{},json:{},images:{},binary:{}},r={},a=[],s=function(e,n,r){var a,s;if(t.isArray(n))for(s=0;s<n.length;s+=1)n[s]=i+"audio/"+n[s];else n=[i+"audio/"+n];t.isDefined(window.Howl)?(a=new Howl({urls:n,onload:r}),o.audio[e]=a):r()},u=function(e,t,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("application/json"),i.open("GET",t,!0),i.onerror=function(){n("Error "+t)},i.ontimeout=function(){n("Timeout"+t)
},i.onreadystatechange=function(){4===i.readyState&&(304===i.status||200===i.status||0===i.status&&i.responseText?n(null,e,JSON.parse(i.responseText)):n("Error: State "+i.readyState+" "+t))},i.send(null)},c=function(e,t,n){var i=new Image;i.src=t,i.addEventListener("load",function(){n(null,e,i)},!1)},d=function(e,i,o){var r,a=t.getKeyLength(e),s=0,c=function(e,r,u){return e?void console.log(e):(n[r]=u,s+=1,t.isDefined(o)&&o(s,a),void(a===s&&t.isDefined(i)&&i(null)))};for(r in e)e.hasOwnProperty(r)&&u(r,e[r],c)},l=function(e,r,d){var l,f=n[e],h=0,p=0,g=function(){h===p&&t.isDefined(r)&&(b(),r(null))},m=function(e,n,i){return e?void console.log(e):(o.images[n]=i,h+=1,t.isDefined(d)&&d(h,p),void g())},v=function(e,n,i){return e?void console.log(e):(o.json[n]=i,a.push(n),h+=1,t.isDefined(d)&&d(h,p),void g())},y=function(e,n,i){return e?void console.log(e):(o.json[n]=i,h+=1,t.isDefined(d)&&d(h,p),void g())},w=function(){h+=1,t.isDefined(d)&&d(h,p),g()};if(!t.isDefined(f))return void r("Could not find asset group "+e);if(t.isDefined(f.path)&&(i=f.path),t.isDefined(f.images)){p+=t.getKeyLength(f.images);for(l in f.images)f.images.hasOwnProperty(l)&&c(l,i+"images/"+f.images[l],m)}if(t.isDefined(f.texturePacker)){p+=t.getKeyLength(f.texturePacker);for(l in f.texturePacker)f.texturePacker.hasOwnProperty(l)&&u(l,i+"json/"+f.texturePacker[l],v)}if(t.isDefined(f.audio)){p+=t.getKeyLength(f.audio);for(l in f.audio)f.audio.hasOwnProperty(l)&&s(l,f.audio[l],w)}if(t.isDefined(f.json)){p+=t.getKeyLength(f.json);for(l in f.json)f.json.hasOwnProperty(l)&&u(l,i+"json/"+f.json[l],y)}},f=function(){},h=function(t){var n,i=r[t];if(!i){if(n=p(t),!n)throw"Can not find "+t;i=e(n),r[t]=i}return i},p=function(e){var n=o.images[e];if(!t.isDefined(n))throw"Asset "+e+" could not be found";return n},g=function(e){var n=o.json[e];if(!t.isDefined(n))throw"Asset "+e+" could not be found";return n},m=function(e){var n=o.audio[e];if(!t.isDefined(n))throw"Asset "+e+" could not be found";return n},v=function(){return o},b=function(){for(var t,n,i,o,s;a.length;){for(n=a.pop(),o=p(n),s=g(n),i=0;i<s.frames.length;++i)name=s.frames[i].filename,name=name.substring(0,name.length-4),t=s.frames[i].frame,r[name]=e(o,t);console.log(r)}};return{loadAssetGroups:d,load:l,unload:f,getImage:h,getImageElement:p,getJson:g,getAudio:m,getAssets:v}}}),define("bento/managers/audio",["bento/utils"],function(e){return function(t){var n,i,o=!1,r=!1,a=!1,s=!1,u="",c=0,d=t.assets,l=(t.getCanvas(),function(e){e?(n=o,i=r,f.muteMusic(!0),f.muteSound(!0)):(o=n,r=i,f.playMusic(u,s))}),f={setVolume:function(e,t){d.getAudio(t).volume(e)},playSound:function(e){o||a||d.getAudio(e).play()},stopSound:function(e){d.getAudio(e).stop()},playMusic:function(t,n,i,o){if(u=t,s=e.isDefined(n)?n:!0,e.isCocoonJS()&&i&&(d.getAudio(t)._audioNode[0].onended=i),!r&&""!==u){if(e.isCocoonJS())return d.getAudio(t)._audioNode[0].currentTime=o||0,d.getAudio(t)._audioNode[0].loop=s,void d.getAudio(t)._audioNode[0].play();d.getAudio(t).loop(s),d.getAudio(t).play(function(e){c=e})}},stopMusic:function(t){return e.isCocoonJS()?void d.getAudio(t)._audioNode[0].pause():void d.getAudio(t).stop()},muteSound:function(e){o=e,o&&this.stopAllSound()},muteMusic:function(t,n){var i=u;r=t,e.isDefined(n)||(n=!1),r?(f.stopAllMusic(),u=i):n&&""!==u&&f.playMusic(u,s)},stopAllSound:function(){var e,t=d.getAssets().audio;for(e in t)t.hasOwnProperty(e)&&"sfx"===e.substring(0,3)&&t[e].stop()},stopAllMusic:function(){var t,n=d.getAssets().audio;for(t in n)if(n.hasOwnProperty(t)&&"bgm"===t.substring(0,3)){if(e.isCocoonJS()){n[t]._audioNode[0].pause();continue}n[t].stop(t===u?c:void 0)}u=""},preventSounds:function(e){a=e}};return"hidden"in document?document.addEventListener("visibilitychange",function(){l(document.hidden)},!1):"mozHidden"in document?document.addEventListener("mozvisibilitychange",function(){l(document.mozHidden)},!1):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",function(){l(document.webkitHidden)},!1):"msHidden"in document?document.addEventListener("msvisibilitychange",function(){l(document.msHidden)},!1):"onpagehide"in window?(window.addEventListener("pagehide",function(){l(!0)},!1),window.addEventListener("pageshow",function(){l(!1)},!1)):"onblur"in document?(window.addEventListener("blur",function(){l(!0)},!1),window.addEventListener("focus",function(){l(!1)},!1),visHandled=!0):"onfocusout"in document&&(window.addEventListener("focusout",function(){l(!0)},!1),window.addEventListener("focusin",function(){l(!1)},!1)),f}}),bento.define("bento/managers/input",["bento/utils","bento/math/vector2","bento/eventsystem"],function(e,t,n){"use strict";return function(i){var o,r,a,s=!1,u=[],c={},d=0,l=0,f=function(e){u.push({id:e.id,position:e.position,eventType:e.eventType,localPosition:e.localPosition,worldPosition:e.worldPosition}),n.fire("pointerDown",e)},h=function(e){n.fire("pointerMove",e),C(e)},p=function(e){n.fire("pointerUp",e),M(e)},g=function(e){var t;for(e.preventDefault(),t=0;t<e.changedTouches.length;t+=1)x(e,t,"start"),f(e)},m=function(e){var t;for(e.preventDefault(),t=0;t<e.changedTouches.length;t+=1)x(e,t,"move"),h(e)},v=function(e){var t;for(e.preventDefault(),t=0;t<e.changedTouches.length;t+=1)x(e,t,"end"),p(e)},b=function(e){e.preventDefault(),_(e),f(e)},y=function(e){e.preventDefault(),_(e),h(e)},w=function(e){e.preventDefault(),_(e),p(e)},x=function(e,n){var i=e.changedTouches[n],o=(i.pageX-d)/r.x,s=(i.pageY-l)/r.y;e.preventDefault(),e.id=0,e.eventType="touch",e.changedTouches[n].position=t(o,s),e.changedTouches[n].worldPosition=e.changedTouches[n].position.clone(),e.changedTouches[n].worldPosition.x+=a.x,e.changedTouches[n].worldPosition.y+=a.y,e.changedTouches[n].localPosition=e.changedTouches[n].position.clone(),e.position=e.changedTouches[n].position.clone(),e.worldPosition=e.changedTouches[n].worldPosition.clone(),e.localPosition=e.changedTouches[n].position.clone(),e.id=e.changedTouches[n].identifier+1},_=function(e){var n=(e.pageX-d)/r.x,i=(e.pageY-l)/r.y;e.id=0,e.eventType="mouse",e.position=t(n,i),e.worldPosition=e.position.clone(),e.worldPosition.x+=a.x,e.worldPosition.y+=a.y,e.localPosition=e.position.clone(),e.id=-1},C=function(e){var t=0;for(t=0;t<u.length;t+=1)if(u[t].id===e.id)return u[t].position=e.position,u[t].worldPosition=e.worldPosition,void(u[t].localPosition=e.position)},M=function(e){var t=0;for(t=0;t<u.length;t+=1)if(u[t].id===e.id)return void u.splice(t,1)},S=function(){o.addEventListener("touchstart",g),o.addEventListener("touchmove",m),o.addEventListener("touchend",v),o.addEventListener("mousedown",b),o.addEventListener("mousemove",y),o.addEventListener("mouseup",w),s=!0,document.body.addEventListener("touchstart",function(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!1}),document.body.addEventListener("touchmove",function(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!1})},A=function(){var e=i.canvas||window,t=function(){e.focus&&e.focus()};e.tabIndex=0,e.focus&&e.focus(),e.addEventListener("keydown",O,!1),e.addEventListener("keyup",P,!1),e.addEventListener("mousedown",t,!1)},O=function(t){var i,o;for(t.preventDefault(),n.fire("keyDown",t),o=e.keyboardMapping[t.keyCode],i=0;i<o.length;++i)c[o[i]]=!0,n.fire("buttonDown",o[i])},P=function(t){var i,o;for(t.preventDefault(),n.fire("keyUp",t),o=e.keyboardMapping[t.keyCode],i=0;i<o.length;++i)c[o[i]]=!1,n.fire("buttonUp",o[i])};if(!i)throw"Supply a settings object";return r=i.canvasScale,o=i.canvas,a=i.viewport,o&&!e.isCocoonJS()&&(d=o.offsetLeft,l=o.offsetTop),S(),A(),{getPointers:function(){return u},resetPointers:function(){u.length=0},isKeyDown:function(e){return c[e]||!1},stop:function(){s&&(o.removeEventListener("touchstart",g),o.removeEventListener("touchmove",m),o.removeEventListener("touchend",v),o.removeEventListener("mousedown",b),o.removeEventListener("mousemove",y),o.removeEventListener("mouseup",w),s=!1)},resume:function(){s||(o.addEventListener("touchstart",g),o.addEventListener("touchmove",m),o.addEventListener("touchend",v),o.addEventListener("mousedown",b),o.addEventListener("mousemove",y),o.addEventListener("mouseup",w),s=!0)}}}}),bento.define("bento/managers/object",["hshg","bento/utils"],function(e,t){"use strict";return function(n,i){var o,r,a=[],s=(new Date).getTime(),u=0,c=30,d=(new Date).getTime(),l={},f=!1,h=!0,p=!1,g=new e,m=function(){i.defaultSort?a.sort(function(e,t){return e.z-t.z}):t.stableSort.inplace(a,function(e,t){return e.z-t.z})},v=function(){var e;for(e=a.length-1;e>=0;--e)null===a[e]&&a.splice(e,1)},b=function(e){var t=(new Date).getTime(),n=t-s;if(f){for(i.debug&&r&&r.tickStart(),s=t,u+=n,o.deltaT=n,i.useDeltaT&&(u=1e3/60);u>=1e3/60;){if(u-=1e3/60,u>1e3/c)for(;u>=1e3/60;)u-=1e3/60;i.useDeltaT&&(u=0),y()}v(),h&&m(),w(),d=e,i.debug&&r&&r.tick(),requestAnimationFrame(b)}},y=function(){var e,t;for(p||(g.update(),g.queryForCollisionPairs()),t=0;t<a.length;++t)e=a[t],e&&e.update&&(p&&e.updateWhenPaused||!p)&&e.update(o)},w=function(){var e,t;for(o.renderer.begin(),t=0;t<a.length;++t)e=a[t],e&&e.draw&&e.draw(o);o.renderer.flush()},x=function(e){var t,n,i;if(e.z=e.z||0,a.push(e),e.init&&e.init(),e.start&&e.start(o),e.attached&&e.attached(o),e.isAdded=!0,e.useHshg&&e.getAABB&&g.addObject(e),e.getFamily)for(i=e.getFamily(),t=0;t<i.length;++t)n=i[t],l[n]||(l[n]=[]),l[n].push(e)},_={attach:x,add:x,remove:function(e){var n,i,r,s;if(e&&(r=a.indexOf(e),r>=0&&(a[r]=null,e.destroy&&e.destroy(o),e.isAdded=!1),e.useHshg&&e.getAABB&&g.removeObject(e),e.getFamily))for(s=e.getFamily(),n=0;n<s.length;++n)i=s[n],t.removeObject(l[i],e)},removeAll:function(e){var t,n;for(t=0;t<a.length;++t)n=a[t],n&&(!n.global||e)&&_.remove(n)},get:function(e,t){var n,i;for(n=0;n<a.length;++n)if(i=a[n],i&&i.name&&i.name===e)return t&&t(i),i;return null},getByName:function(e,t){var n,i,o=[];for(n=0;n<a.length;++n)i=a[n],i&&i.name&&i.name===e&&o.push(i);return t&&o.length&&t(o),o},getByFamily:function(e,t){var n=l[e];return n||(l[e]=[],n=l[e],console.log("Warning: family called "+e+" does not exist")),t&&n.length&&t(n),n},stop:function(){f=!1},run:function(){f||(f=!0,b())},count:function(){return a.length},pause:function(){p=!0},resume:function(){p=!1},isPaused:function(){return p},draw:function(){w()}};return window.performance||(window.performance={now:Date.now}),o=n,i.debug&&t.isDefined(window.FPSMeter)&&(FPSMeter.defaults.graph=1,r=new FPSMeter),_}}),bento.define("bento/managers/savestate",["bento/utils"],function(e){"use strict";var t,n=document.URL,i={setItem:function(e,t){var n,o=0;i[e]=t;for(n in i)i.hasOwnProperty(n)&&++o;this.length=o},getItem:function(t){var n=i[t];return e.isDefined(n)?n:null},removeItem:function(e){delete i[e]},clear:function(){this.length=0},length:0};try{if(t=window.localStorage,!window.localStorage)throw"No local storage available";window.localStorage.setItem(n+"save","0")}catch(o){console.log("Warning: you have disabled cookies on your browser. You cannot save progress in your game."),t=i}return{save:function(e,i){"string"!=typeof e&&(e=JSON.stringify(e)),t.setItem(n+e,JSON.stringify(i))},load:function(e,i){var o;return o=t.getItem(n+e),null===o?i:JSON.parse(o)},remove:function(e){t.removeItem(n+e)},clear:function(){t.clear()},debug:function(){console.log(localStorage)},isEmpty:function(){return 0===t.length},setId:function(e){n=e}}}),bento.define("bento/managers/screen",["bento/utils"],function(){"use strict";return function(){var e={},t=null,n={add:function(t){if(!t.name)throw"Add name property to screen";e[t.name]=t},show:function(i,o,r){null!==t&&n.hide(),t=e[i],t?(t.onShow&&t.onShow(o),r&&r()):bento.require([i],function(e){e.name||(e.name=i),n.add(e),n.show(i,o,r)})},hide:function(e){t&&(t.onHide(e),t=null)},getCurrentScreen:function(){return t}};return n}}),bento.define("bento/math/array2d",function(){"use strict";return function(e,t){var n,i,o=[];for(n=0;e>n;++n)for(o[n]=[],i=0;t>i;++i)o[n][i]=null;return{isArray2d:function(){return!0},iterate:function(n){var i,r;for(r=0;t>r;++r)for(i=0;e>i;++i)n(i,r,o[i][r])},get:function(e,t){return o[e][t]},set:function(e,t,n){o[e][t]=n}}}}),bento.define("bento/math/matrix",["bento/utils"],function(e){"use strict";var t=function(e){var t=this.clone();return t.addTo(e),t},n=function(){var e=this.clone();return e.multiplyWith(other),e},i=function(o,r){var a,s,u=[],c=o||0,d=r||0,l=function(e,t,n){u[t*c+e]=n},f=function(e,t){return u[t*c+e]};for(s=0;d>s;++s)for(a=0;c>a;++a)a===s?l(a,s,1):l(a,s,0);return{isMatrix:function(){return!0},stringify:function(){var e,t,n="",i="";for(t=0;d>t;++t){for(e=0;c>e;++e)i+=f(e,t)+"	";n+=i+"\n",i=""}return n},get:function(e,t){return f(e,t)},set:function(e,t,n){l(e,t,n)},setValues:function(e){var t,n=Math.min(u.length,e.length);for(t=0;n>t;++t)u[t]=e[t];return this},getWidth:function(){return c},getHeight:function(){return d},iterate:function(t){var n,i;for(i=0;d>i;++i)for(n=0;c>n;++n){if(!e.isFunction(t))throw"Please supply a callback function";t(n,i,f(n,i))}},transpose:function(){var e,t,n=[];for(e=0;c>e;++e)for(t=0;d>t;++t)n[e*d+t]=f(e,t);return u=n,d=[c,c=d][0],this},addTo:function(e){var t,n;if(d!=e.getHeight()||c!=e.getWidth())throw"Matrix sizes incorrect";for(n=0;d>n;++n)for(t=0;c>t;++t)l(t,n,f(t,n)+e.get(t,n));return this},add:t,multiplyWith:function(e){var t,n,i,o=[],r=c,a=d,s=e.getHeight(),l=e.getWidth(),h=0;if(a!=l)throw"Matrix sizes incorrect";for(n=0;s>n;++n)for(t=0;r>t;++t){for(h=0,i=0;l>i;++i)h+=e.get(i,n)*f(t,i);o[n*r+t]=h}return u=o,c=r,d=s,this},multiply:n,clone:function(){var e=i(c,d);return e.setValues(u),e}}};return i}),bento.define("bento/math/polygon",["bento/utils","bento/math/rectangle"],function(e,t){"use strict";var n=function(){return!0},i=function(){for(var e=[],t=this.points,n=t.length;n--;)e[n]=t[n];return u(e)},o=function(e){for(var t=[],n=this.points,i=n.length;i--;)t[i]=n[i],t[i].x+=e.x,t[i].y+=e.y;return u(t)},r=function(e,t,n,i){var o,r,a=function(e,t){return e.x*t.y-e.y*t.x},s=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},u=s(t,e),c=s(i,n),d=a(s(n,e),u),l=a(u,c);return 0===d&&0===l?n.x-e.x<0!=n.x-t.x<0!=i.x-e.x<0!=i.x-t.x<0||n.y-e.y<0!=n.y-t.y<0!=i.y-e.y<0!=i.y-t.y<0:0===l?!1:(o=d/l,r=a(s(n,e),c)/l,r>=0&&1>=r&&o>=0&&1>=o)},a=function(e){var t,n,i,o,a,s,c=[],d=this.points;if(e.isRectangle){if(!this.getBoundingBox().intersect(e))return!1;c.push({x:e.x,y:e.y}),c.push({x:e.getX2(),y:e.y}),c.push({x:e.getX2(),y:e.getY2()}),c.push({x:e.x,y:e.getY2()}),e=u(c)}else{if(!this.getBoundingBox().intersect(e.getBoundingBox()))return!1;c=e.points}for(a=0;a<d.length;++a)for(s=0;s<c.length;++s)if(t=d[a],n=d[(a+1)%d.length],i=c[s],o=c[(s+1)%c.length],r(t,n,i,o))return!0;return this.hasPosition(c[0])||e.hasPosition(d[0])?!0:!1},s=function(e){var t=this.points,n=!1,i=0,o=t.length-1,r=this.getBoundingBox();if(e.x<r.x||e.x>r.x+r.width||e.y<r.y||e.y>r.y+r.height)return!1;for(o;i<t.length;o=i++)t[i].y>e.y!=t[o].y>e.y&&e.x<(t[o].x-t[i].x)*(e.y-t[i].y)/(t[o].y-t[i].y)+t[i].x&&(n=!n);return n},u=function(e){var r,u=e[0].x,c=e[0].x,d=e[0].y,l=e[0].y,f=1;for(f=1;f<e.length;++f)r=e[f],u=Math.min(r.x,u),c=Math.max(r.x,c),d=Math.min(r.y,d),l=Math.max(r.y,l);return{x:u,y:d,width:c-u,height:l-d,points:e,isPolygon:n,getBoundingBox:function(){return t(u,d,c-u,l-d)},hasPosition:s,intersect:a,offset:o,clone:i}};return u}),bento.define("bento/math/rectangle",["bento/utils"],function(){"use strict";var e=function(){return!0},t=function(){return this.x+this.width},n=function(){return this.y+this.height},i=function(e){var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.getX2(),e.getX2()),o=Math.max(this.getY2(),e.getY2());return d(t,n,i-t,o-n)},o=function(e){return e.isPolygon?e.intersect(this):!(this.x+this.width<=e.x||this.y+this.height<=e.y||this.x>=e.x+e.width||this.y>=e.y+e.height)},r=function(e){var t=d(0,0,0,0);return this.intersect(e)&&(t.x=Math.max(this.x,e.x),t.y=Math.max(this.y,e.y),t.width=Math.min(this.x+this.width,e.x+e.width)-t.x,t.height=Math.min(this.y+this.height,e.y+e.height)-t.y),t},a=function(e){return d(this.x+e.x,this.y+e.y,this.width,this.height)},s=function(){return d(this.x,this.y,this.width,this.height)},u=function(e){return!(e.x<this.x||e.y<this.y||e.x>=this.x+this.width||e.y>=this.y+this.height)},c=function(e){this.x-=e/2,this.y-=e/2,this.width+=e,this.height+=e},d=function(d,l,f,h){return{x:d,y:l,width:f,height:h,isRectangle:e,getX2:t,getY2:n,union:i,intersect:o,intersection:r,offset:a,clone:s,hasPosition:u,grow:c}};return d}),bento.define("bento/math/vector2",["bento/math/matrix"],function(e){"use strict";var t=function(){return!0},n=function(e){var t=this.clone();return t.addTo(e),t},i=function(e){return this.x+=e.x,this.y+=e.y,this},o=function(e){var t=this.clone();return t.substractFrom(e),t},r=function(e){return this.x-=e.x,this.y-=e.y,this},a=function(){return Math.atan2(this.y,this.x)},s=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},u=function(e){return this.x*e.x+this.y*e.y},c=function(e){var t=this.clone();return t.multiplyWith(e),t},d=function(e){return this.x*=e.x,this.y*=e.y,this},l=function(e){var t=this.clone();return t.divideBy(e),t},f=function(e){return this.x/=e.x,this.y/=e.y,this},h=function(e){var t=this.clone();return t.scalarMultiplyWith(e),t},p=function(e){return this.x*=e,this.y*=e,this},g=function(e){return this.x*=e,this.y*=e,this},m=function(){return Math.sqrt(this.dotProduct(this))},v=function(){var e=this.length();return this.x/=e,this.y/=e,this},b=function(e){return e.substract(this).length()},y=function(e){var t=this.x*Math.cos(e)-this.y*Math.sin(e),n=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=n,this},w=function(e){return this.rotateRadian(e*Math.PI/180)},x=function(){return C(this.x,this.y)},_=function(){var t=e(1,3);return t.set(0,0,this.x),t.set(0,1,this.y),t.set(0,2,1),t},C=function(e,C){return{x:e,y:C,isVector2:t,add:n,addTo:i,substract:o,substractFrom:r,angle:a,angleBetween:s,dotProduct:u,multiply:c,multiplyWith:d,divide:l,divideBy:f,scalarMultiply:h,scalarMultiplyWith:p,scale:g,length:m,normalize:v,distance:b,rotateRadian:y,rotateDegree:w,clone:x,toMatrix:_}};return C}),bento.define("bento/autoresize",["bento/utils"],function(){return function(e,t,n,i){var o=e.clone(),r=window.innerWidth,a=window.innerHeight,s=i?r:a,u=i?a:r,c=function(){temp=e.width,e.width=e.height,e.height=temp},d=function(){var r,a=2,d=e.height,l=s/u,f=e.height/e.width;for(1>l?(f=l,r=s):(f=u/s,r=u),d=r,r*=window.devicePixelRatio||1,console.log(r);d>n;)if(d=Math.floor(r/a),a+=1,t>d){d=i?o.height:o.width;break}return e.width=d/f,e.height=d,i||c(),e},l=function(){window.scrollTo(0,0)};return window.addEventListener("orientationchange",l,!1),i||c(),d()}}),bento.define("bento/screen",["bento/utils","bento","bento/math/rectangle","bento/tiled"],function(e,t,n,i){"use strict";return function(n){var o,r=t.getViewport(),a=n&&n.dimension?n.dimension:r.clone(),s={name:null,setDimension:function(e){a.width=e.width,a.height=e.height},getDimension:function(){return a},extend:function(t){return e.extend(this,t)},loadTiled:function(e){o=i({name:e,spawn:!0}),this.setDimension(o.dimension)},onShow:function(e){n&&(n.tiled&&this.loadTiled(n.tiled),n.onShow&&n.onShow(e))},onHide:function(e){t.removeAll(),r.x=0,r.y=0,n.onHide&&n.onHide(e)}};return s}}),define("bento/tiled",["bento","bento/entity","bento/math/vector2","bento/math/rectangle","bento/math/polygon","bento/packedimage","bento/utils"],function(e,t,n,i,o,r,a){"use strict";return function(n){var s,u,c,d,l,f,h=e.assets.getJson(n.name),p=h.width,g=h.height,m=h.layers.length,v=h.tilewidth,b=h.tileheight,y=document.createElement("canvas"),w=y.getContext("2d"),x=[],_=[],C=e.getViewport(),M=t().extend({z:0,draw:function(e){var t=Math.max(Math.min(y.width-C.x,C.width),0),n=Math.max(Math.min(y.height-C.y,C.height),0),i=r(y);0!==t&&0!==n&&e.renderer.drawImage(i,~~Math.max(Math.min(C.x,y.width),0),~~Math.max(Math.min(C.y,y.height),0),~~t,~~n,0,0,~~t,~~n)}}),S=function(e){var t,n,i=null;for(t=0;t<h.tilesets.length;++t)n=h.tilesets[t],n.firstgid<=e&&(i=n);return i},A=function(t,n){var i,o,r;return null===t?null:(i=n-t.firstgid,o=Math.floor(t.imagewidth/t.tilewidth),r=Math.floor(t.imageheight/t.tileheight),{subimage:e.assets.getImage(t.name),x:i%o*t.tilewidth,y:Math.floor(i/o)*t.tileheight,width:t.tilewidth,height:t.tileheight})},O=function(e,t){var n=d.data[t*p+e],i=S(n),o=A(i,n);o&&w.drawImage(o.subimage.image,o.subimage.x+o.x,o.subimage.y+o.y,o.width,o.height,e*v,t*b,v,b)},P=function(t,i,o){var r=i.x,s=i.y,u={};a.extend(u,o),a.extend(u,i.properties),require([t],function(t){var i=t.apply(this,[u]),o=i.getOrigin(),a=i.getDimension();i.setPosition({x:r+o.x,y:s+(o.y-a.height)}),n.spawn&&e.objects.add(i),x.push(i)})},E=function(e){var t,n,i=e.gid,o=S(i),r=i-o.firstgid;o.tileproperties&&(t=o.tileproperties[r.toString()],t&&(n=t.module)),n&&P(n,e,t)},I=function(i,o){var r;n.spawn&&(r=t({z:0,name:o,family:[o],useHshg:!0,staticHshg:!0}).extend({update:function(){},draw:function(){}}),r.setBoundingBox(i),e.objects.add(r)),i.type=o,_.push(i)};for(y.width=p*v,y.height=g*b,c=0;m>c;++c)if(d=h.layers[c],"tilelayer"===d.type)for(u=0;u<d.height;++u)for(s=0;s<d.width;++s)O(s,u);else if("objectgroup"===d.type)for(s=0;s<d.objects.length;++s)if(l=d.objects[s],""===l.type&&(l.type="solid"),l.gid)E(l);else if(l.polygon){for(f=[],u=0;u<l.polygon.length;++u)f.push({x:l.polygon[u].x+l.x,y:l.polygon[u].y+l.y+1});I(o(f),l.type)}else I(i(l.x,l.y,l.width,l.height),l.type);return n.spawn&&e.objects.add(M),{tileLayer:M,objects:x,shapes:_,dimension:i(0,0,v*p,b*g)}}}),bento.define("bento/tween",["bento","bento/utils","bento/entity"],function(e,t,n){"use strict";var i={easeInQuad:function(e,t,n,i){return n*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-n*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return n*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-n*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0===e?t:n*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){return e===i?t+n:n*(-Math.pow(2,-10*e/i)+1)+t},easeInOutExpo:function(e,t,n,i){return 0===e?t:e===i?t+n:(e/=i/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,n,i){return-n*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return n*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){return(e/=i/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,i){var o=1.70158,r=0,a=n;return 0===e?t:1===(e/=i)?t+n:(r||(r=.3*i),a<Math.abs(n)?(a=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/a),-(a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-o)*Math.PI/r))+t)},easeOutElastic:function(e,t,n,i){var o=1.70158,r=0,a=n;return 0===e?t:1===(e/=i)?t+n:(r||(r=.3*i),a<Math.abs(n)?(a=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*e)*Math.sin(2*(e*i-o)*Math.PI/r)+n+t)},easeInOutElastic:function(e,t,n,i){var o=1.70158,r=0,a=n;return 0===e?t:2===(e/=i/2)?t+n:(r||(r=.3*i*1.5),a<Math.abs(n)?(a=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/a),1>e?-.5*a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-o)*Math.PI/r)+t:a*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*i-o)*Math.PI/r)*.5+n+t)},easeInBack:function(e,t,n,i,o){return void 0===o&&(o=1.70158),n*(e/=i)*e*((o+1)*e-o)+t},easeOutBack:function(e,t,n,i,o){return void 0===o&&(o=1.70158),n*((e=e/i-1)*e*((o+1)*e+o)+1)+t},easeInOutBack:function(e,t,n,i,o){return void 0===o&&(o=1.70158),(e/=i/2)<1?n/2*e*e*(((o*=1.525)+1)*e-o)+t:n/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},easeInBounce:function(e,t,n,i){return n-this.easeOutBounce(i-e,0,n,i)+t},easeOutBounce:function(e,t,n,i){return(e/=i)<1/2.75?7.5625*n*e*e+t:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,n,i){return i/2>e?.5*this.easeInBounce(2*e,0,n,i)+t:.5*this.easeOutBounce(2*e-i,0,n,i)+.5*n+t}},o={linear:function(e,t,n){return(t-e)*n+e},quadratic:function(e,t,n){return(t-e)*n*n+e},squareroot:function(e,t,n){return(t-e)*Math.pow(n,.5)+e},cubic:function(e,t,n){return(t-e)*n*n*n+e},cuberoot:function(e,t,n){return(t-e)*Math.pow(n,1/3)+e},exponential:function(e,t,n,i){return(t-e)/(Math.exp(i)-1)*Math.exp(i*n)+e-(t-e)/(Math.exp(i)-1)},elastic:function(e,t,n,i,o){return(t-e)/(Math.exp(i)-1)*Math.cos(o*n*2*Math.PI)*Math.exp(i*n)+e-(t-e)/(Math.exp(i)-1)},sin:function(e,t,n,i){return e+t*Math.sin(i*n*2*Math.PI)},cos:function(e,t,n,i){return e+t*Math.cos(i*n*2*Math.PI)}},r=function(e,t,n,r,a,s){var u=o[e];return u?u(t,n,r,a,s):i[e](r,t,n-t,1)};return function(i){var o=0,a=!1,s=!0,u=n(i).extend({id:i.id,update:function(){s&&(++o,i["do"]&&i["do"].apply(this,[r(i.ease||"linear",i.from||0,t.isDefined(i.to)?i.to:1,o/i["in"],t.isDefined(i.alpha)?i.alpha:1,t.isDefined(i.beta)?i.beta:1),o]),!i.stay&&o>=i["in"]&&(i.onComplete&&i.onComplete.apply(this),e.objects.remove(u),a=!1))},begin:function(){return o=0,a||(e.objects.add(u),a=!0),s=!0,u},stop:function(){return o=0,s=!1,u}});return 0===i["in"]&&(i["in"]=1),u.begin(),u}}),bento.define("bento/renderers/canvas2d",["bento/utils"],function(){return function(e,t){var n=e.getContext("2d"),i=n,o={name:"canvas2d",save:function(){n.save()},restore:function(){n.restore()},translate:function(e,t){n.translate(e,t)},scale:function(e,t){n.scale(e,t)},rotate:function(e){n.rotate(e)},fillRect:function(e,t,i,o,a){var s=r(e),u=n.globalAlpha;1!==e[3]&&(n.globalAlpha=e[3]),n.fillStyle=s,n.fillRect(t,i,o,a),1!==e[3]&&(n.globalAlpha=u)},fillCircle:function(e,t,i,o){{var a=r(e);n.globalAlpha}1!==e[3]&&(n.globalAlpha=e[3]),n.fillStyle=a,n.beginPath(),n.arc(t,i,o,0,2*Math.PI),n.fill(),n.closePath()},strokeRect:function(e,t,i,o,a){var s=r(e),u=n.globalAlpha;1!==e[3]&&(n.globalAlpha=e[3]),n.strokeStyle=s,n.strokeRect(t,i,o,a),1!==e[3]&&(n.globalAlpha=u)},drawImage:function(e,t,i,o,r,a,s,u,c){n.drawImage(e.image,e.x+t,e.y+i,o,r,a,s,u,c)},getOpacity:function(){return n.globalAlpha},setOpacity:function(e){n.globalAlpha=e},createSurface:function(t,n){var i,o=document.createElement("canvas");return o.width=t,o.height=n,i=e.getContext("2d")},setContext:function(e){n=e},restoreContext:function(){n=i}},r=function(e){var t="#";return t+=("00"+Math.floor(255*e[0]).toString(16)).slice(-2),t+=("00"+Math.floor(255*e[1]).toString(16)).slice(-2),t+=("00"+Math.floor(255*e[2]).toString(16)).slice(-2)};return console.log("Init canvas2d as renderer"),t.smoothing||(n.imageSmoothingEnabled&&(n.imageSmoothingEnabled=!1),n.webkitImageSmoothingEnabled&&(n.webkitImageSmoothingEnabled=!1),n.mozImageSmoothingEnabled&&(n.mozImageSmoothingEnabled=!1)),o}}),bento.define("bento/renderers/pixi",["bento","bento/utils"],function(e){return function(t){var n,i,o={name:"pixi",init:function(){},destroy:function(){},save:function(){},restore:function(){},translate:function(){},scale:function(){},rotate:function(){},fillRect:function(){},fillCircle:function(){},drawImage:function(){},flush:function(){var t=e.getViewport();n.x=t.x,n.y=t.y,i.render(n)},addChild:function(e){n.addChild(e)},removeChild:function(e){n.removeChild(e)}};if(!window.PIXI)throw"Pixi library missing";return n=new PIXI.Container,i=PIXI.autoDetectRenderer(t.width,t.height,{view:t,backgroundColor:0}),console.log("Init pixi as renderer"),console.log(i.view===t),o}}),bento.define("bento/renderers/webgl",["bento/utils","bento/renderers/canvas2d"],function(e,t){return function(n,i){var o,r,a,s=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}(),u={name:"webgl",save:function(){r.save()},restore:function(){r.restore()},translate:function(e,t){r.translate(e,t)},scale:function(e,t){r.scale(e,t)},rotate:function(e){r.rotate(e)},fillRect:function(e,t,n,i,o){var a=r.color;u.setColor(e),r.fillRect(t,n,i,o),r.color=a},fillCircle:function(){},strokeRect:function(e,t,n,i,o){var a=r.color;u.setColor(e),r.strokeRect(t,n,i,o),r.color=a},drawImage:function(e,t,n,i,a,s,u){var c=e.image;c.texture||(c.texture=window.GlSprites.createTexture2D(o,c)),r.drawImage(c.texture,e.x+t,e.y+n,i,a,s,u,i,a)},begin:function(){r.begin()},flush:function(){r.end()},setColor:function(e){r.color=e},getOpacity:function(){return r.color[3]},setOpacity:function(e){r.color[3]=e},createSurface:function(e,t){var i,o,r=document.createElement("canvas");return r.width=e,r.height=t,i=n.getContext("webgl")||n.getContext("experimental-webgl"),o=window.GlSprites.SpriteRenderer(i),o.ortho(n.width,n.height),o},setContext:function(e){r=e},restoreContext:function(){r=a}};return console.log("Init webgl as renderer"),s&&e.isDefined(window.GlSprites)?(o=n.getContext("webgl")||n.getContext("experimental-webgl"),r=window.GlSprites.SpriteRenderer(o),r.ortho(n.width,n.height),a=r,u):(console.log("webgl failed, revert to canvas"),t(n,i))}}),bento.define("bento/gui/clickbutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/eventsystem"],function(e,t,n,i,o,r,a,s,u){"use strict";return function(n){var s=(e.getViewport(),!0),c=a.extend({z:0,name:"",originRelative:t(.5,.5),position:t(0,0),components:[i,o],family:["buttons"],sprite:{image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]}}},clickable:{onClick:function(){d.sprite.setAnimation("down")},onHoldEnter:function(){d.sprite.setAnimation("down")},onHoldLeave:function(){d.sprite.setAnimation("up")},pointerUp:function(){d.sprite.setAnimation("up")},onHoldEnd:function(){s&&n.onClick&&(n.onClick.apply(d),n.sfx&&(e.audio.stopSound(n.sfx),e.audio.playSound(n.sfx)),u.fire("clickButton",d))}},init:function(){this.sprite.setAnimation("up")}},n),d=r(c).extend({setActive:function(e){s=e},doCallback:function(){n.onClick.apply(d)}});return a.isDefined(n.active)&&(s=n.active),d}}),bento.define("bento/gui/counter",["bento","bento/entity","bento/math/vector2","bento/components/sprite","bento/components/translation","bento/components/rotation","bento/components/scale","bento/utils"],function(e,t,n,i,o,r,a,s){"use strict";return function(e){var u,c=e.value||0,d=e.spacing||n(0,0),l=e.align||e.alignment||"right",f=0,h=[],p=function(){return Math.floor(c).toString().length},g=function(){return t({components:[i],sprite:{image:e.image,frameWidth:e.frameWidth,frameHeight:e.frameHeight,animations:{0:{frames:[0]},1:{frames:[1]},2:{frames:[2]},3:{frames:[3]},4:{frames:[4]},5:{frames:[5]},6:{frames:[6]},7:{frames:[7]},8:{frames:[8]},9:{frames:[9]}}},init:function(){f=e.frameWidth}})},m=function(){var e,t,i,o=c.toString(),r=p(),a=h.length-r;if(0>a)for(e=0;e<Math.abs(a);++e)i=g(),h.push(i),u.attach(i);else if(a>0)for(e=0;e<Math.abs(a);++e)i=h.pop(),u.remove(i);for(e=0;e<h.length;++e)i=h[e],i.setPosition(n((f+d.x)*e,0)),i.sprite.setAnimation(o.substr(e,1));if("right"===l)for(e=0;e<h.length;++e)i=h[e],t=i.getPosition().clone(),t.substract(n((f+d.x)*r-d.x,0)),i.setPosition(t);else if("center"===l)for(e=0;e<h.length;++e)i=h[e],t=i.getPosition(),t.addTo(n(((f+d.x)*r-d.x)/-2,0))},v={z:e.z,name:e.name,position:e.position,components:[o,r,a]};return s.extend(v,e),u=t(v).extend({init:function(){m()},setValue:function(e){c=e,m()
},getValue:function(){return c},addValue:function(e){c+=e,m()},getDigits:function(){return p()}})}}),bento.define("bento/gui/togglebutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(e,t,n,i,o,r,a){"use strict";return function(n){var s=(e.getViewport(),!0),u=!1,c=a.extend({z:0,name:"",originRelative:t(.5,.5),position:t(0,0),components:[i,o],family:["buttons"],sprite:{image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]}}},clickable:{onClick:function(){d.sprite.setAnimation("down")},onHoldEnter:function(){d.sprite.setAnimation("down")},onHoldLeave:function(){d.sprite.setAnimation(u?"down":"up")},pointerUp:function(){d.sprite.setAnimation(u?"down":"up")},onHoldEnd:function(){s&&(u=u?!1:!0,n.onToggle&&(n.onToggle.apply(d),n.sfx&&(e.audio.stopSound(n.sfx),e.audio.playSound(n.sfx))),d.sprite.setAnimation(u?"down":"up"))}},init:function(){}},n),d=r(c).extend({isToggled:function(){return u},toggle:function(t,i){u=a.isDefined(t)?t:!u,i&&n.onToggle&&(n.onToggle.apply(d),n.sfx&&(e.audio.stopSound(n.sfx),e.audio.playSound(n.sfx))),d.sprite.setAnimation(u?"down":"up")}});return a.isDefined(n.active)&&(s=n.active),n.toggled&&(u=!0),d.sprite.setAnimation(u?"down":"up"),d}});